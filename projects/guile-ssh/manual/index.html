<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual documents Guile-SSH version 0.15.1.

Copyright (C) 2014-2022 Artyom V. Poptsov

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled "GNU Free
Documentation License."
 -->
<!-- Created on September 11, 2022 by texi2html 5.0
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Guile-SSH Reference Manual</title>

<meta name="description" content="Guile-SSH Reference Manual">
<meta name="keywords" content="Guile-SSH Reference Manual">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 5.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:pre}
span.nolinebreak {white-space:pre}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>

<h1>Guile-SSH Reference Manual</h1>
<h3 align="right">For Guile-SSH 0.15.1</h3>

<strong>Artyom V. Poptsov</strong><br>


<p>This manual documents Guile-SSH version 0.15.1.
</p>
<p>Copyright (C) 2014-2022 Artyom V. Poptsov
</p>
<p>Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled &ldquo;GNU Free
Documentation License.&rdquo;
</p><hr>
<a name="Top"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[ &lt; ]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="The-Guile_002dSSH-Reference-Manual"></a>
<h1 class="top">The Guile-SSH Reference Manual</h1>

<p>This manual documents Guile-SSH version 0.15.1.
</p>
<p>Copyright (C) 2014-2022 Artyom V. Poptsov
</p>
<p>Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, no Front-Cover Texts, and no Back-Cover Texts.  A
copy of the license is included in the section entitled &ldquo;GNU Free
Documentation License.&rdquo;
</p><br>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Introduction">1 Introduction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Installation">2 Installation</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#API-Reference">3 API Reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Examples">4 Examples</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Acknowledgments">5 Acknowledgments</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Appendices

</pre></th></tr><tr><td align="left" valign="top"><a href="#GNU-Free-Documentation-License">Appendix A GNU Free Documentation License</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">  The license of this manual.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Indices

</pre></th></tr><tr><td align="left" valign="top"><a href="#Type-Index">Type Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Procedure-Index">Procedure Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Concept-Index">Concept Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr></table>


<hr size="6">
<a name="Introduction"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#The-goals-of-this-_0028humble_0029-project" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Introduction-1"></a>
<h1 class="chapter">1 Introduction</h1>

<p>Guile-SSH is a library that provides access to the <acronym>SSH</acronym>
protocol for programs written in
<a href="https://www.gnu.org/software/guile/">GNU Guile</a>.  It is a wrapper
to the underlying <a href="http://www.libssh.org/">libssh</a> library.  This
manual is partly based on libssh documentation.
</p>
<hr>
<a name="The-goals-of-this-_0028humble_0029-project"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">1.1 The goals of this (humble) project</h2>
<blockquote>
<p>Most projects are humble, it&rsquo;s the combination that&rsquo;s interesting :-)
</p></blockquote>
<p align="center">&mdash; <em>Ludovic Court√®s</em>
</p>
<p>Now let me explain what are the goals of the whole project.  Aside from the
fact that I am having lots of fun with the project itself (and the project is
helping me to grow as a free software developer, many thanks to all advices
and comments from the community!), there are practical goals that the project
struggling to achieve.
</p>
<p>For me, the main goal is to provide convenient means to write truly
distributed applications in my favourite programming language.
</p>
<p>Computers are getting cheaper and more and more ubiquitous, and so different
kind of networks.  In my opinion the question is &ndash; how we are going to
utilize those new computational resources?  Using multi-core systems
effectively may be tricky; fortunately some languages (such as Scheme/GNU
Guile) already provide convenient API to utilize those systems.  But what
about systems that distributed over a network?
</p>
<p>I am dreaming of the times when using computer resources distributed over a
network in GNU Guile will be as easy as using local ones.  You should not be
asking question &ldquo;how to do it?&rdquo; &ndash; what you should be asking yourself is
&ldquo;how can I use it?&rdquo;
</p>
<p>But Guile-SSH itself is just a library; a tool that can be used to solve some
problems (and, perhaps, to cause new ones ;-)).  So, as was noted in the
quotation above, it&rsquo;s the combination of projects that may lead to the most
interesting results.  With that said, I would love to see Guile-SSH used in
another projects, and to hear positive (and negative) feedback from you.
</p>
<p>Happy hacking!
</p>
<p>- avp
</p>
<hr>
<a name="Installation"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#The-goals-of-this-_0028humble_0029-project" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#GNU-Guix" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Installation-1"></a>
<h1 class="chapter">2 Installation</h1>

<hr>
<a name="GNU-Guix"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ubuntu-GNU_002fLinux" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.1 GNU Guix</h2>
<p>The latest stable Guile-SSH is available from <a href="https://guix.gnu.org/">GNU Guix</a> repository:
</p>
<div class="example">
<pre class="example">$ guix install guile-ssh
</pre></div>

<p>If you want to get the environment for Guile-SSH development there&rsquo;s
&lsquo;<tt>guix.scm</tt>&rsquo; file in the root of the repository that can be used with
<code>guix shell</code>:
</p>
<div class="example">
<pre class="example">$ guix shell -D -f ./guix.scm
</pre></div>

<hr>
<a name="Ubuntu-GNU_002fLinux"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#GNU-Guix" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Platforms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.2 Ubuntu GNU/Linux</h2>
<div class="example">
<pre class="example">$ sudo apt install guile-ssh
</pre></div>

<hr>
<a name="Other-Platforms"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ubuntu-GNU_002fLinux" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Manual-Installation" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.3 Other Platforms</h2>
<p>Guile-SSH is also available from the default repositories at least on the
following platforms:
</p><ul>
<li> <a href="https://aur.archlinux.org/packages/guile-ssh/">Arch GNU/Linux</a>
</li><li> <a href="https://www.parabola.nu/packages/?q=guile-ssh">Parabola GNU/Linux</a>
</li><li> <a href="https://software.opensuse.org/package/guile-ssh">openSUSE GNU/Linux</a>
</li><li> <a href="https://github.com/aconchillo/homebrew-guile">macOS</a>
</li></ul>

<p>Please refer to the official document for each platform for the instructions
on how to install the package.
</p>
<hr>
<a name="Manual-Installation"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Other-Platforms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Installation" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">2.4 Manual Installation</h2>
<p>Guile-SSH sources are available from GitHub at
<a href="https://github.com/artyom-poptsov/guile-ssh/">https://github.com/artyom-poptsov/guile-ssh/</a>.  This section describes
requirements of Guile-SSH and the manual installation process.
</p>
<p>Guile-SSH depends on the following packages:
</p>
<ul>
<li> <a href="https://www.gnu.org/software/guile/">GNU Guile</a>, version 2.0.9 or later
</li><li> <a href="http://www.libssh.org/">libssh</a>, version 0.6.4 or later
</li></ul>

<p>Get the sources of Guile-SSH from GitHub:
</p>
<div class="example">
<pre class="example">$ git clone git@github.com:artyom-poptsov/guile-ssh.git
</pre></div>

<p>Configure the sources:
</p>
<div class="example">
<pre class="example">$ cd guile-ssh/
$ autoreconf -if
$ ./configure
</pre></div>

<p>Build and install the library:
</p>
<div class="example">
<pre class="example">$ make
$ make install
</pre></div>

<p>For a basic explanation of the installation of the package, see the
&lsquo;<tt>INSTALL</tt>&rsquo; file.
</p>
<p>Please <strong>note</strong> that you will need
<a href="https://www.gnu.org/software/automake/">Automake</a> version 1.12 or
later to run self-tests with <code>make check</code> (but the library
itself can be built with older Automake version such as 1.11).
</p>
<p><strong>important</strong> You probably want to call <code>configure</code> with
the &lsquo;<samp>--with-guilesitedir</samp>&rsquo; option so that this package is
installed in Guile&rsquo;s default path.  But, if you don&rsquo;t know where your
Guile site directory is, run <code>configure</code> without the option,
and it will give you a suggestion.
</p>
<hr>
<a name="API-Reference"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Installation" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Manual-Installation" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Sessions" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="API-Reference-1"></a>
<h1 class="chapter">3 API Reference</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Sessions">3.1 Sessions</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Session management
</td></tr>
<tr><td align="left" valign="top"><a href="#Auth">3.2 Auth</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Authentication procedures
</td></tr>
<tr><td align="left" valign="top"><a href="#Agent">3.3 Agent</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Interaction with SSH agent instances.
</td></tr>
<tr><td align="left" valign="top"><a href="#Keys">3.4 Keys</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Public and private keys
</td></tr>
<tr><td align="left" valign="top"><a href="#Channels">3.5 Channels</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Channel manipulation procedures
</td></tr>
<tr><td align="left" valign="top"><a href="#Tunnels">3.6 Tunnels</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      SSH tunnels
</td></tr>
<tr><td align="left" valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"> Creating of input, output or bidirectional pipes to remote
                 processes
</td></tr>
<tr><td align="left" valign="top"><a href="#Shell">3.8 Shell</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        A high-level interface to remote shell built upon remote
                 pipes
</td></tr>
<tr><td align="left" valign="top"><a href="#Logging">3.9 Logging</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Interface to the libssh logging
</td></tr>
<tr><td align="left" valign="top"><a href="#Version">3.10 Version</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Get information about versions
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Guile-SSH Server API
</pre></th></tr><tr><td align="left" valign="top"><a href="#Servers">3.11 Servers</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">      Creating and managing Guile-SSH servers
</td></tr>
<tr><td align="left" valign="top"><a href="#Messages">3.12 Messages</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Handling of messages
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
SFTP
</pre></th></tr><tr><td align="left" valign="top"><a href="#SFTP">3.13 SFTP</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Guile-SSH SFTP client API.
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
Distributed Computing
</pre></th></tr><tr><td align="left" valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><th colspan="3" align="left" valign="top"><pre class="menu-comment">
</pre></th></tr></table>


<hr>
<a name="Sessions"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Session-Management" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Sessions-1"></a>
<h2 class="section">3.1 Sessions</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Callbacks">3.1.2 Callbacks</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Session-Management"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Sessions" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Sessions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Callbacks" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Session-Management-1"></a>
<h3 class="subsection">3.1.1 Session Management</h3>

<a name="index-sessions"></a>
<a name="index-session"></a>

<p>A session is an object that holds all the information about connection
to a specified server or a client.  This information includes server&rsquo;s
port and address, name of the user, compression level, private keys
and so on.
</p>
<p>A session may contain zero or more channels (see section <a href="#Channels">Channels</a>).
Channels are &ldquo;pipes&rdquo; that link the client and the server together
and that can be used for transferring of data in both directions.
</p>
<p>So the overall picture can be thought like this:
</p>
<div class="example">
<pre class="example">[client]                      [server]

    \____________________________/  SSH session

     ============================
     ============================   SSH channels
     ============================
     ____________________________
    /                            \
</pre></div>


<p>libssh docs say that there is no limit to number of channels for a
single session in theory.
</p>
<p>This chapter describes session management.  The code is in the
<code>(ssh session)</code> module.
</p>

<dl>
<dt><a name="index-session_003f"></a>Scheme Procedure: <strong>session?</strong><em> x</em></dt>
<dd><p>Returns <code>#t</code> if <var>x</var> is a Guile-SSH session, <code>#f</code>
otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-_0025make_002dsession"></a>Scheme Procedure: <strong>%make-session</strong></dt>
<dd><p>Create a new Guile-SSH session.
</p></dd></dl>

<dl>
<dt><a name="index-make_002dsession"></a>Scheme Procedure: <strong>make-session</strong><em> [keywords]</em></dt>
<dd><p>Create a new Guile-SSH session and set its options.  Options can be
passed as keywords.
</p>
<p>Return a new Guile-SSH session.
</p>
<p>This procedure is more convenient than primitive <code>%make-session</code>,
but on other hand it should be a bit slower because of additional
checks.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((s (make-session #:user          &quot;alice&quot;
                       #:host          &quot;example.com&quot;
                       #:port          12345
                       #:identity      &quot;/home/alice/.ssh/id_rsa&quot;
                       #:log-verbosity 'nolog)))
  ...)
</pre></div>

<p>List of allowed keywords:
</p><dl compact="compact">
<dt>&lsquo;<samp>add-identity</samp>&rsquo;</dt>
<dt>&lsquo;<samp>callbacks</samp>&rsquo;</dt>
<dt>&lsquo;<samp>ciphers-c-s</samp>&rsquo;</dt>
<dt>&lsquo;<samp>ciphers-s-c</samp>&rsquo;</dt>
<dt>&lsquo;<samp>compression</samp>&rsquo;</dt>
<dt>&lsquo;<samp>compression-c-s</samp>&rsquo;</dt>
<dt>&lsquo;<samp>compression-level</samp>&rsquo;</dt>
<dt>&lsquo;<samp>compression-s-c</samp>&rsquo;</dt>
<dt>&lsquo;<samp>config</samp>&rsquo;</dt>
<dt>&lsquo;<samp>host</samp>&rsquo;</dt>
<dt>&lsquo;<samp>identity</samp>&rsquo;</dt>
<dt>&lsquo;<samp>knownhosts</samp>&rsquo;</dt>
<dt>&lsquo;<samp>log-verbosity</samp>&rsquo;</dt>
<dt>&lsquo;<samp>nodelay</samp>&rsquo;</dt>
<dt>&lsquo;<samp>port</samp>&rsquo;</dt>
<dt>&lsquo;<samp>proxycommand</samp>&rsquo;</dt>
<dt>&lsquo;<samp>public-key-accepted-types</samp>&rsquo;</dt>
<dd><p>Preferred public key algorithms to be used for authentication (comma-separated
list as a string). Example:
&ldquo;ssh-rsa,rsa-sha2-256,ssh-dss,ecdh-sha2-nistp256&rdquo;
</p>
<p>This option available only in libssh 0.8.3 or later versions.
</p></dd>
<dt>&lsquo;<samp>ssh-dir</samp>&rsquo;</dt>
<dt>&lsquo;<samp>ssh1</samp>&rsquo;</dt>
<dt>&lsquo;<samp>ssh2</samp>&rsquo;</dt>
<dt>&lsquo;<samp>stricthostkeycheck</samp>&rsquo;</dt>
<dt>&lsquo;<samp>timeout</samp>&rsquo;</dt>
<dt>&lsquo;<samp>timeout-usec</samp>&rsquo;</dt>
<dt>&lsquo;<samp>user</samp>&rsquo;</dt>
</dl>

</dd></dl>

<dl>
<dt><a name="index-blocking_002dflush_0021"></a>Scheme Procedure: <strong>blocking-flush!</strong><em> session timeout</em></dt>
<dd><p>Blocking flush of the outgoing buffer of <var>session</var>.  Return on of
the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>ok</samp>&rsquo;</dt>
<dd><p>Success.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p><var>timeout</var> occurred.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>An error occurred.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt><a name="index-session_002dset_0021"></a>Scheme Procedure: <strong>session-set!</strong><em> session option value</em></dt>
<dd><p>Set a <var>option</var> to <code>value</code> for the given Guile-SSH
<var>session</var>.  Throw a <code>guile-ssh-error</code> on error.  Return value
is undefined.
</p>
<p>Here is the description of available options.  The description is
based on libssh documentation:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>host</samp>&rsquo;</dt>
<dd><p>The hostname or <acronym>IP</acronym> address to connect to.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>port</samp>&rsquo;</dt>
<dd><p>The port to connect to.
</p>
<p>Expected type of <var>value</var>: number.
</p></dd>
<dt>&lsquo;<samp>fd</samp>&rsquo;</dt>
<dd><p>The file descriptor to use.
</p>
<p>If you wish to open the socket yourself for a reason or another, set
the file descriptor.  Don&rsquo;t forget to set the hostname as the hostname
is used as a key in the known_host mechanism.
</p>
<p>Expected type of <var>value</var>: number.
</p></dd>
<dt>&lsquo;<samp>bindaddr</samp>&rsquo;</dt>
<dd><p>The address to bind the client to.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>user</samp>&rsquo;</dt>
<dd><p>The username for authentication.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>ssh-dir</samp>&rsquo;</dt>
<dd><p>Set the SSH directory.
</p>
<p>The ssh directory is used for files like known_hosts and identity
(private and public key).  It may include <code>%s</code> which will be
replaced by the user home directory.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>identity</samp>&rsquo;</dt>
<dd><p>Set the identity file name.  By default identity, &lsquo;<tt>id_dsa</tt>&rsquo; and
&lsquo;<tt>id_rsa</tt>&rsquo; are checked.
</p>
<p>The identity file used authenticate with public key.  It may include
<code>%s</code> which will be replaced by the user home directory.
</p>
</dd>
<dt>&lsquo;<samp>knownhosts</samp>&rsquo;</dt>
<dd><p>Set the known hosts file name.  Default value is &lsquo;<tt>~/.ssh/known_hosts</tt>&rsquo;.
</p>
<p>The known hosts file is used to certify remote hosts are genuine.  The
string may include <code>%s</code> which will be replaced by the user home
directory.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>timeout</samp>&rsquo;</dt>
<dd><p>Set a timeout for the connection in seconds.
</p>
<p>Expected type of <var>value</var>: number.
</p></dd>
<dt>&lsquo;<samp>timeout-usec</samp>&rsquo;</dt>
<dd><p>Set a timeout for the connection in micro seconds.
</p>
<p>Expected type of <var>value</var>: number.
</p></dd>
<dt>&lsquo;<samp>ssh1</samp>&rsquo;</dt>
<dd><p>Allow or deny the connection to SSH1 servers.
</p>
<p>Expected type of <var>value</var>: boolean.
</p></dd>
<dt>&lsquo;<samp>ssh2</samp>&rsquo;</dt>
<dd><p>Allow or deny the connection to SSH2 servers
</p>
<p>Expected type of <var>value</var>: boolean.
</p></dd>
<dt>&lsquo;<samp>log-verbosity</samp>&rsquo;</dt>
<dd><p>Set the session logging verbosity.  Possible values:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>nolog</samp>&rsquo;</dt>
<dd><p>No logging at all
</p></dd>
<dt>&lsquo;<samp>rare</samp>&rsquo;</dt>
<dd><p>Only rare and noteworthy events
</p></dd>
<dt>&lsquo;<samp>protocol</samp>&rsquo;</dt>
<dd><p>High level protocol information
</p></dd>
<dt>&lsquo;<samp>packet</samp>&rsquo;</dt>
<dd><p>Lower level protocol infomations, packet level
</p></dd>
<dt>&lsquo;<samp>functions</samp>&rsquo;</dt>
<dd><p>Every function path
</p></dd>
</dl>

<p>Expected type of <var>value</var>: symbol.
</p></dd>
<dt>&lsquo;<samp>ciphers-c-s</samp>&rsquo;</dt>
<dd><p>Set the symmetric cipher client to server.  The <var>value</var> must be a
string of comma-separated values.
</p></dd>
<dt>&lsquo;<samp>ciphers-s-c</samp>&rsquo;</dt>
<dd><p>Set the symmetric cipher server to client.  The <var>value</var> must be a
string of comma-separated values.
</p></dd>
<dt>&lsquo;<samp>compression-c-s</samp>&rsquo;</dt>
<dd><p>Set the compression to use for client to server.  The <var>value</var> must
be &ldquo;yes&rdquo;, &ldquo;no&rdquo; or a specific algorithm name if needed (&quot;zlib&quot;,
<tt>&quot;zlib@openssh.com&quot;</tt>, &quot;none&quot;).
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>compression-s-c</samp>&rsquo;</dt>
<dd><p>Set the compression to use for server to client.  The <var>value</var> must
be &ldquo;yes&rdquo;, &ldquo;no&rdquo; or a specific algorithm name if needed (&quot;zlib&quot;,
<tt>&quot;zlib@openssh.com&quot;</tt>, &quot;none&quot;).
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>proxycommand</samp>&rsquo;</dt>
<dd><p>Set the command to be executed in order to connect to server.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>stricthostkeycheck</samp>&rsquo;</dt>
<dd><p>Set the parameter <code>StrictHostKeyChecking</code> to avoid asking about a
fingerprint.
</p></dd>
<dt>&lsquo;<samp>compression</samp>&rsquo;</dt>
<dd><p>Set the compression to use for both directions communication.  The
<var>value</var> must be &ldquo;yes&rdquo;, &ldquo;no&rdquo; or a specific algorithm name if
needed (&quot;zlib&quot;, <tt>&quot;zlib@openssh.com&quot;</tt>, &quot;none&quot;).
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>compression-level</samp>&rsquo;</dt>
<dd><p>Set the compression level to use for zlib functions.  The <var>value</var>
is expected to be a number from 1 to 9, 9 being the most efficient but
slower.
</p>
</dd>
<dt>&lsquo;<samp>callbacks</samp>&rsquo;</dt>
<dd><p>Set callbacks that will be called on related events (see section <a href="#Callbacks">Callbacks</a>.)
</p>
<p>Expected type of <var>value</var>: an association list (alist).
</p>
</dd>
<dt>&lsquo;<samp>config</samp>&rsquo;</dt>
<dd><p>The option specifies whether an SSH config should be parsed or not, and
optionally the path to a config file.
</p>
<p>Setting the <var>value</var> to <code>#t</code> means that the default
&lsquo;<tt>~/.ssh/config</tt>&rsquo; should be parsed; in turn, setting the option to
<code>#f</code> (the default value) means that the config should not be parsed at
all.  If the value is a string, then the string is expected to be a path to
config file.
</p>
<p>The procedure reads the config file after all other specified options are set.
When the config file is read, the options for <var>session</var> are set,
overwriting those that were passed to the procedure.
</p>
<p>You <em>must</em> specify at least a host name when using this option, otherwise
the procedure will fail.
</p>
<p>Optionally you could use <code>session-parse-config!</code> procedure explicitly to
read the config (see below.)
</p>
<p>Expected types of <var>value</var>: Either a string or a boolean value.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-session_002dparse_002dconfig_0021"></a>Scheme Procedure: <strong>session-parse-config!</strong><em> session [file-name]</em></dt>
<dd><p>Parse an SSH config <var>file-name</var> and set <var>session</var> options.  If
<var>file-name</var> is not set, the default SSH &lsquo;<tt>~/.ssh/config</tt>&rsquo; is used.
Throw <code>guile-ssh-error</code> on an error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-session_002dget"></a>Scheme Procedure: <strong>session-get</strong><em> session option</em></dt>
<dd><p>Get value of the <var>option</var> for <var>session</var>.  The <var>option</var> is expected
to be a symbol.
</p>
<p>Please not that currently not all the possible session options can be gotten
with this procedure.  Here is the list of allowed options:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>host</samp>&rsquo;</dt>
<dt>&lsquo;<samp>port</samp>&rsquo;</dt>
<dt>&lsquo;<samp>user</samp>&rsquo;</dt>
<dt>&lsquo;<samp>identity</samp>&rsquo;</dt>
<dt>&lsquo;<samp>proxycommand</samp>&rsquo;</dt>
<dt>&lsquo;<samp>callbacks</samp>&rsquo;</dt>
</dl>
</dd></dl>

<dl>
<dt><a name="index-connect_0021"></a>Scheme Procedure: <strong>connect!</strong><em> session</em></dt>
<dd><p>Connect <var>session</var> to a SSH server.  Return one of the following symbols:
<code>ok</code>, <code>again</code>, <code>error</code>.
</p></dd></dl>

<dl>
<dt><a name="index-disconnect_0021"></a>Scheme Procedure: <strong>disconnect!</strong><em> session</em></dt>
<dd><p>Disconnect the <var>session</var>.  This procedure can be used by a client
as well as by a server.
</p></dd></dl>

<dl>
<dt><a name="index-authenticate_002dserver"></a>Scheme Procedure: <strong>authenticate-server</strong><em> session</em></dt>
<dd><p>Authenticate the server. 
</p>
<p>Throw <code>wrong-type-arg</code> exception if a disconnected <var>session</var> is
passed as an argument.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>ok</samp>&rsquo;</dt>
<dd><p>The server is known and has not changed.
</p></dd>
<dt>&lsquo;<samp>known-changed</samp>&rsquo;</dt>
<dd><p>The server key has changed. Either you are under attack or the
administrator changed the key. You <em>have</em> to warn the user about
a possible attack.
</p></dd>
<dt>&lsquo;<samp>found-other</samp>&rsquo;</dt>
<dd><p>The server gave use a key of a type while we had an other type
recorded. It is a possible attack.
</p></dd>
<dt>&lsquo;<samp>not-known</samp>&rsquo;</dt>
<dd><p>The server is unknown. User should confirm the MD5 is correct.
</p></dd>
<dt>&lsquo;<samp>file-not-found</samp>&rsquo;</dt>
<dd><p>The known host file does not exist. The host is thus unknown. File
will be created if host key is accepted.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>An error occurred.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-get_002dserver_002dpublic_002dkey"></a>Scheme Procedure: <strong>get-server-public-key</strong><em> session</em></dt>
<dd><p>Get server public key from a <var>session</var>.  Return the server&rsquo;s
public key.  Throw <code>guile-ssh-error</code> on error.
</p>
<p>Also throw <code>wrong-type-arg</code> exception if a disconnected <var>session</var> is
passed as an argument.
</p>
<p>See also <code>get-public-key-hash</code> in see section <a href="#Keys">Keys</a>.
</p></dd></dl>

<dl>
<dt><a name="index-write_002dknown_002dhost_0021"></a>Scheme Procedure: <strong>write-known-host!</strong><em> session</em></dt>
<dd><p>Write the current server as known in the known hosts file.  Throw
<code>guile-ssh-error</code> on error.  Throw <code>wrong-type-arg</code> exception if a
disconnected session is passed as an argument.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-connected_003f"></a>Scheme Procedure: <strong>connected?</strong><em> session</em></dt>
<dd><p>Check if we are connected.  Return <code>#f</code> if we are connected to a
server, <code>#f</code> if we aren&rsquo;t.
</p></dd></dl>

<dl>
<dt><a name="index-get_002derror"></a>Scheme Procedure: <strong>get-error</strong><em> session</em></dt>
<dd><a name="index-handling-session-errors"></a>
<p>Retrieve the error text message from the last error related to
<var>session</var>.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dprotocol_002dversion"></a>Scheme Procedure: <strong>get-protocol-version</strong><em> session</em></dt>
<dd><p>Get version of SSH protocol.  Return 1 for SSH1, 2 for SSH2 or
<code>#f</code> on error.
</p>
<p>Throw <code>wrong-type-arg</code> exception if a disconnected <var>session</var> is
passed as an argument.
</p></dd></dl>

<hr>
<a name="Callbacks"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Session-Management" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Sessions" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Auth" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Callbacks-1"></a>
<h3 class="subsection">3.1.2 Callbacks</h3>

<p>Guile-SSH uses an association list (alist) to represent session callbacks; the
key is a callback name, and the value is expecting to be a procedure.
</p>
<p>Session callbacks is the way to handle some events, notably the incoming
reverse port forwarding requests on the server side.  Each callback is called
with the optional <code>user-data</code> argument which can be specified in the
callbacks alist as well.
</p>
<dl>
<dt><a name="index-global_002drequest_002dcallback"></a>Scheme Procedure: <strong>global-request-callback</strong><em> session message user-data</em></dt>
<dd><p>A server-side callback that is called on a global request (e.g. when an SSH
client asks for reverse port forwarding.)
</p>
<p>The callback should be set on an accepted Guile-SSH session (see section <a href="#Servers">Servers</a>)
in case when global requests must be handled; note that if the callback is not
set then the server will always deny global requests, which may be confusing.
</p>
<p>Example:
</p><div class="lisp">
<pre class="lisp">(define (handle-global-request session message user-data)
  (let ((port-number 12345))
    (message-reply-success message port-number)))

;; Let's suppose that the session was created earlier.

;; Now we can set our callback:
(session-set! session
              'callbacks 
              `((user-data               . #f)
                (global-request-callback . ,handle-global-request)))

;; Note that 'user-data' is optional, so the following example
;; is valid:
(session-set! session
              'callbacks
              `((global-request-callback . ,handle-global-request)))
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-connect_002dstatus_002dcallback"></a>Scheme Procedure: <strong>connect-status-callback</strong><em> session status user-data</em></dt>
<dd><p>This callback is called during connection establishment process (that is,
after <code>connect!</code> is called) with a server.  A connection <var>status</var> is
a number that shows what percentage of connection esablishment is done.
</p>
<p>Example:
</p><div class="lisp">
<pre class="lisp">(define (print-status session status user-data)
  (let ((percentage (truncate (* status 100))))
    (format #t &quot;~a: connecting ... ~a%~%&quot; session percentage)))

;; Let's suppose that the session was created earlier.

(session-set! session
              'callbacks
              `((user-data               . #f)
                (connect-status-callback . ,print-status)))

;; Or we can set two callbacks simultaneously:

(define (handle-global-request session message user-data)
  (let ((port-number 12345))
    (message-reply-success message port-number)))

(session-set! session
              'callbacks
              `((user-data               . #f)
                (connect-status-callback . ,print-status)
                (global-request-callback . ,handle-global-request)))
</pre></div>
</dd></dl>


<hr>
<a name="Auth"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Callbacks" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Agent" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Auth-1"></a>
<h2 class="section">3.2 Auth</h2>

<a name="index-authentication"></a>

<p>The <code>(ssh auth)</code> module provides authentication procedures for a
Guile-SSH client.
</p>
<p>Please note that you must specify a username either on creation of a
session or by <code>session-set!</code> call (see section <a href="#Sessions">Sessions</a>) before
calling of procedures from this section.
</p>
<p>Also <strong>note</strong> that the session must be connected before calling to these
procedures, otherwise the <code>wrong-type-arg</code> exception will be thrown.
</p>
<dl>
<dt><a name="index-userauth_002dpublic_002dkey_0021"></a>Scheme Procedure: <strong>userauth-public-key!</strong><em> session private-key</em></dt>
<dd><p>Try to authenticate with a public/private key.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another
method.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dpublic_002dkey_002fauto_0021"></a>Scheme Procedure: <strong>userauth-public-key/auto!</strong><em> session</em></dt>
<dd><a name="index-authentication-with-a-SSH-agent"></a>
<p>Try to automatically authenticate with <code>none</code> method first and
then with public keys.  The procedure will try to get a cached private
key from a <acronym>SSH</acronym> agent and if it fails it will try to read a
key from a file.  If the key is encrypted the user will be asked for a
passphrase.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another
method.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dpublic_002dkey_002ftry"></a>Scheme Procedure: <strong>userauth-public-key/try</strong><em> session public-key</em></dt>
<dd><p>Try to authenticate with the given <var>public-key</var>.
</p>
<p>To avoid unnecessary processing and user interaction, the following
method is provided for querying whether authentication using the
<var>public-key</var> would be possible.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>The public key is accepted, you want now to use
<code>userauth-public-key!</code>.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another
method.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dagent_0021"></a>Scheme Procedure: <strong>userauth-agent!</strong><em> session</em></dt>
<dd><p>Try to do public key authentication with ssh agent.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another
method.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dpassword_0021"></a>Scheme Procedure: <strong>userauth-password!</strong><em> session password</em></dt>
<dd><p>Try to authenticate by <var>password</var>.
</p>
<p>Return one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another
method.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>In nonblocking mode, you&rsquo;ve got to call this again later.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dgssapi_0021"></a>Scheme Procedure: <strong>userauth-gssapi!</strong><em> session</em></dt>
<dd><p>Try to authenticate through the <code>gssapi-with-mic</code> method.
</p>
<p>Return one of the following symbols: 
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another method.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>In nonblocking mode, you&rsquo;ve got to call this again later.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dnone_0021"></a>Scheme Procedure: <strong>userauth-none!</strong><em> session</em></dt>
<dd><p>Try to authenticate through the <code>none</code> method.
</p>
<p>Return one of the following symbols: 
</p>
<dl compact="compact">
<dt>&lsquo;<samp>success</samp>&rsquo;</dt>
<dd><p>Authentication success.
</p></dd>
<dt>&lsquo;<samp>partial</samp>&rsquo;</dt>
<dd><p>You&rsquo;ve been partially authenticated, you still have to use another method.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>In nonblocking mode, you&rsquo;ve got to call this again later.
</p></dd>
<dt>&lsquo;<samp>denied</samp>&rsquo;</dt>
<dd><p>Authentication failed: use another method.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>A serious error happened.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-userauth_002dget_002dlist"></a>Scheme Procedure: <strong>userauth-get-list</strong><em> session</em></dt>
<dd><p>Get available authentication methods for a <var>session</var>.  Return list
of available methods.
</p>
<p>This call will block, even in nonblocking mode, if run for the first
time before a (complete) call to <code>userauth-none!</code>.
</p>
<p>Possible methods are: <code>password</code>, <code>public-key</code>,
<code>host-based</code>, <code>interactive</code>.
</p>
</dd></dl>


<hr>
<a name="Agent"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Auth" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Starting_002fstopping-SSH-agents" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Agent-1"></a>
<h2 class="section">3.3 Agent</h2>

<a name="index-agent"></a>

<p>The <code>(ssh agent)</code> module provides procedures for interacting with SSH
authentication agent instances.
</p>
<hr>
<a name="Starting_002fstopping-SSH-agents"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Agent" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Agent" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-information-about-SSH-agents" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.3.1 Starting/stopping SSH agents</h3>

<dl>
<dt><a name="index-ssh_002dagent_002dstart"></a>Scheme Procedure: <strong>ssh-agent-start</strong></dt>
<dd><p>Start an OpenSSH agent. Return a list with SSH agent information of the
following form:
</p>
<div class="lisp">
<pre class="lisp">'((SSH_AUTH_SOCK . &lt;agent-socket-file-path&gt;)
  (SSH_AGENT_PID . &lt;agent-pid&gt;))
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-ssh_002dagent_002dstop"></a>Scheme Procedure: <strong>ssh-agent-stop</strong></dt>
<dd><p>Kill the current agent (given by the <code>SSH_AGENT_PID</code> environment
variable).
</p></dd></dl>

<hr>
<a name="Getting-information-about-SSH-agents"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Starting_002fstopping-SSH-agents" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Agent" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Managing-SSH-agent-environment-variables" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.3.2 Getting information about SSH agents</h3>

<dl>
<dt><a name="index-ssh_002dagent_002dinfo"></a>Scheme Procedure: <strong>ssh-agent-info</strong><em> [#:user=(getenv &quot;USER&quot;)] [#:path=(or (getenv &quot;TMPDIR&quot;) &quot;/tmp&quot;)]</em></dt>
<dd>
<p>The procedure tries to find information about all running SSH authentication
agent instances by searching the specified <var>path</var> for a given <var>user</var>.
</p>
<p>The agent subdirectory pattern is used as specified in the <code>ssh-agent</code>
man page: <code>ssh-XXXXXXXXXX/agent.&lt;ppid&gt;</code>
</p>
<p>Returns an associative list of the following form:
</p><div class="lisp">
<pre class="lisp">'(((SSH_AUTH_SOCK . &lt;agent-socket-file-path-1&gt;)
   (SSH_AGENT_PID . &lt;agent-pid-1&gt;))
  ((SSH_AUTH_SOCK . &lt;agent-socket-file-path-2&gt;)
   (SSH_AGENT_PID . &lt;agent-pid-2&gt;))
  ...)
</pre></div>

<p>One might use the procedure to configure the environment in a REPL to use SSH
<code>userauth-agent!</code> procedure later:
</p>
<div class="lisp">
<pre class="lisp">(define s (make-session #:host &quot;localhost&quot;))
(connect! s)
(ssh-agent-sock-set! (assoc-ref (car (ssh-agent-info)) 'SSH_AUTH_SOCK))
(userauth-agent! s)
(with-ssh (make-node s) (version))
</pre></div>

</dd></dl>

<hr>
<a name="Managing-SSH-agent-environment-variables"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Getting-information-about-SSH-agents" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Agent" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Keys" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.3.3 Managing SSH agent environment variables</h3>

<dl>
<dt><a name="index-ssh_002dagent_002dsock_002dget"></a>Scheme Procedure: <strong>ssh-agent-sock-get</strong></dt>
<dd><p>Get the <code>SSH__AGENT__SOCK</code> environment variable value.
</p></dd></dl>

<dl>
<dt><a name="index-ssh_002dagent_002dsock_002dset_0021"></a>Scheme Procedure: <strong>ssh-agent-sock-set!</strong><em> sock-file</em></dt>
<dd><p>Set the value of <code>SSH__AGENT__SOCK</code> environment variable to the
<var>sock-file</var>.
</p></dd></dl>


<hr>
<a name="Keys"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Managing-SSH-agent-environment-variables" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Channels" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Keys-1"></a>
<h2 class="section">3.4 Keys</h2>

<a name="index-public-keys"></a>
<a name="index-private-keys"></a>
<a name="index-key"></a>

<p>The <code>(ssh key)</code> module provides procedures for handling of
Guile-SSH keys.
</p>
<p><strong>Note</strong> that Guile-SSH does not support ECDSA keys if libssh 0.6.3 is
compiled with GCrypt instead of OpenSSL.
</p>
<dl>
<dt><a name="index-make_002dkeypair"></a>Scheme Procedure: <strong>make-keypair</strong><em> type length</em></dt>
<dd><p>Generate a keypair of specified <var>type</var> and <var>length</var> (in bits).  This
may take some time.
</p>
<p>Possible key types are: <code>dss</code>, <code>rsa</code>, <code>rsa1</code>, <code>ecdsa</code>.
</p>
<p>Return newly generated private key.  Throw <code>guile-ssh-error</code> on error.
</p></dd></dl>

<dl>
<dt><a name="index-key_003f"></a>Scheme Procedure: <strong>key?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a Guile-SSH key, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-public_002dkey_003f"></a>Scheme Procedure: <strong>public-key?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a Guile-SSH key and it <strong>contains</strong> a
public key, <code>#f</code> otherwise.  What it means is that the procedure will
return <code>#t</code> for a private key too (because the private key contains a
public key in some sense).
</p></dd></dl>

<dl>
<dt><a name="index-private_002dkey_003f"></a>Scheme Procedure: <strong>private-key?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a Guile-SSH private key, <code>#f</code>
otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-public_002dkey_002d_003estring"></a>Scheme Procedure: <strong>public-key-&gt;string</strong><em> public-key</em></dt>
<dd><p>Convert <var>public-key</var> to a string.
</p></dd></dl>

<dl>
<dt><a name="index-string_002d_003epublic_002dkey"></a>Scheme Procedure: <strong>string-&gt;public-key</strong><em> string type</em></dt>
<dd><p>Convert a public key of <var>type</var> represented as Base64 <var>string</var>
to a Guile-SSH key.  Throw <code>guile-ssh-error</code> on error.
</p>
<p>The <var>type</var> must be one of the following symbols: <code>dss</code>,
<code>rsa</code>, <code>rsa1</code>, <code>ecdsa</code>
</p></dd></dl>

<dl>
<dt><a name="index-private_002dkey_002dfrom_002dfile"></a>Scheme Procedure: <strong>private-key-from-file</strong><em> file</em></dt>
<dd><p>Read private key from a <var>file</var>.  If the the key is encrypted the
user will be asked for passphrase to decrypt the key.
</p>
<p>Return a new Guile-SSH key of <code>#f</code> on error.
</p></dd></dl>

<dl>
<dt><a name="index-private_002dkey_002dto_002dfile"></a>Scheme Procedure: <strong>private-key-to-file</strong><em> private-key file-name</em></dt>
<dd><p>Export <var>private-key</var> to a PAM file <var>file-name</var> on a disk.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p>
<p><strong>Note</strong> that this procedure won&rsquo;t work if libssh 0.6.3 is compiled with
GCrypt cryptographic library.
</p></dd></dl>

<dl>
<dt><a name="index-private_002dkey_002d_003epublic_002dkey"></a>Scheme Procedure: <strong>private-key-&gt;public-key</strong><em> private-key</em></dt>
<dd><p>Get a public key from the <var>private-key</var>.
</p></dd></dl>

<dl>
<dt><a name="index-public_002dkey_002dfrom_002dfile"></a>Scheme Procedure: <strong>public-key-from-file</strong><em> session file</em></dt>
<dd><p>Read public key from a <var>file</var>.  Return a public key or <code>#f</code>
on error.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dkey_002dtype"></a>Scheme Procedure: <strong>get-key-type</strong><em> key</em></dt>
<dd><p>Get a symbol that represents the type of the Guile-SSH <var>key</var>.
Possible types are: <code>dss</code>, <code>rsa</code>, <code>rsa1</code>, <code>unknown</code>.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dpublic_002dkey_002dhash"></a>Scheme Procedure: <strong>get-public-key-hash</strong><em> public-key type</em></dt>
<dd><a name="index-fingerprint"></a>
<a name="index-fingerprint-1"></a>
<p>Get a <var>public-key</var> hash of <var>type</var> as a bytevector.  Return the
bytevector on success, <code>#f</code> on error.
</p>
<p>See also <code>get-server-public-key</code> in see section <a href="#Sessions">Sessions</a>.
</p>
<p>The <var>type</var> can be one of the following symbols: <code>md5</code>,
<code>sha1</code>.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((pubkey (get-server-public-key session)))
  (get-public-key-hash pubkey 'md5))
&rArr; #vu8(15 142 110 203 162 228 250 211 20 212 26 217 118 57 217 66)
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-bytevector_002d_003ehex_002dstring"></a>Scheme Procedure: <strong>bytevector-&gt;hex-string</strong><em> bv</em></dt>
<dd><a name="index-fingerprint-2"></a>
<a name="index-fingerprint-3"></a>
<p>Convert the given bytevector <var>bv</var> to a colon separated string.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((hash (get-public-key-hash pubkey 'md5)))
  (bytevector-&gt;hex-string hash))
&rArr; &quot;0f:8e:6e:cb:a2:e4:fa:d3:14:d4:1a:d9:76:39:d9:42&quot;
</pre></div>

</dd></dl>


<hr>
<a name="Channels"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Keys" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Channel-Management" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Channels-1"></a>
<h2 class="section">3.5 Channels</h2>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Channel-Management"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Channels" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Channels" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Port-Forwarding" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Channel-Management-1"></a>
<h3 class="subsection">3.5.1 Channel Management</h3>

<a name="index-data-transferring"></a>
<a name="index-channel"></a>

<p>The <code>(ssh channel)</code> module provides facilities to create
Guile-SSH channels and manipulating of them.
</p>
<p>Channels are implemented as GNU Guile ports.  Therefore they can be
used with regular I/O procedures such as <code>display</code>, <code>write</code>,
<code>read-line</code> and friends (see <a href="guile.html#Input-and-Output">Input and Output</a> in <cite>The GNU Guile Reference Manual</cite>).  This section describes operations that
are specific for the channels.
</p>
<p>When a channel is closed by the remote side, the local side detects it;
reading from such channel gives an EOF object when all data is read.
</p>
<p>Note that when the parent session from which a channel is made is freed the
channel is freed as well.
</p>
<dl>
<dt><a name="index-channel_003f"></a>Scheme Procedure: <strong>channel?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a Guile-SSH channel, <code>#f</code>
otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-make_002dchannel"></a>Scheme Procedure: <strong>make-channel</strong><em> session [mode]</em></dt>
<dd><p>Allocate a new Guile-SSH channel for the <var>session</var> (see section <a href="#Sessions">Sessions</a>).
</p>
<p><var>flags</var> are determine what kind of a channel should be created.  Possible
modes are: <code>OPEN_READ</code>, <code>OPEN_WRITE</code>, <code>OPEN_BOTH</code>.  They allow
to create either an input channel, output channel or input/output channel
respectively.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dopen_002dsession"></a>Scheme Procedure: <strong>channel-open-session</strong><em> channel</em></dt>
<dd><p>Open a session channel.  This procedure actually turn the
<var>channel</var> into an open port available for I/O operations.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dopen_003f"></a>Scheme Procedure: <strong>channel-open?</strong><em> channel</em></dt>
<dd><p>Return <code>#t</code> if a <var>channel</var> is open, #f otherwise.  Note that this procedure
also returns <code>#f</code> when the remote side is closed.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002drequest_002dexec"></a>Scheme Procedure: <strong>channel-request-exec</strong><em> channel command</em></dt>
<dd><a name="index-non_002dinteractive-SSH-session"></a>
<a name="index-command-execution"></a>
<p>Run a shell <var>command</var> without an interactive shell.  The <var>channel</var>
must be open.  Throw <code>guile-ssh-error</code> on error.  Return value is
undefined.
</p>
<p>This procedure is a low-level one and you should use remote pipes instead (see section <a href="#Remote-Pipes">Remote Pipes</a>).
</p>
<p><strong>Note</strong> that the procedure only can be used to execute a single command
on the remote host, so you should close the channel after
<code>channel-request-exec</code>.  If you want to execute another command then you
must open a new channel and use it.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((channel (make-channel session)))
  (channel-open-session channel)
  (channel-request-exec channel &quot;uname&quot;)
  (read-line channel))
&rArr; &quot;Linux&quot;
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-channel_002drequest_002dpty"></a>Scheme Procedure: <strong>channel-request-pty</strong><em> channel</em></dt>
<dd><p>Request a <acronym>PTY</acronym> (pseudo terminal).  Throw <code>guile-ssh-error</code> on
error.  The <var>channel</var> must be open.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002drequest_002dshell"></a>Scheme Procedure: <strong>channel-request-shell</strong><em> channel</em></dt>
<dd><p>Request a shell.  The <var>channel</var> must be open.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002drequest_002denv"></a>Scheme Procedure: <strong>channel-request-env</strong><em> channel variable value</em></dt>
<dd><a name="index-setting-of-environment-variables"></a>
<p>Set an environment <var>variable</var> to <var>value</var>.  Throw
<code>guile-ssh-error</code> on error.  The <var>channel</var> must be open.  Return
value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002drequest_002dsend_002dexit_002dstatus"></a>Scheme Procedure: <strong>channel-request-send-exit-status</strong><em> channel exit-status</em></dt>
<dd><p>Send an <var>exit-status</var> to the remote process (as described in RFC 4254,
section 6.10).  Only SSH-v2 is supported.  Return value is undefined.
</p>
<p>The <var>channel</var> needs to be closed with after this message.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dset_002dpty_002dsize_0021"></a>Scheme Procedure: <strong>channel-set-pty-size!</strong><em> channel columns rows</em></dt>
<dd><p>Change size of the <acronym>PTY</acronym> to <var>columns</var> and <var>rows</var>.  The
<var>channel</var> must be open.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dset_002dstream_0021"></a>Scheme Procedure: <strong>channel-set-stream!</strong><em> channel stream</em></dt>
<dd><p>Set default <var>stream</var> for <var>channel</var>.  <var>stream</var> must be one of the
following symbols: <code>stdout</code> (default), <code>stderr</code>.  The <var>channel</var>
must be open.  Throw <code>guile-ssh-error</code> on error.  Return value is
undefined.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(channel-set-stream! channel 'stderr)
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-channel_002dget_002dstream"></a>Scheme Procedure: <strong>channel-get-stream</strong><em> channel</em></dt>
<dd><p>Get current stream name from <var>channel</var>.  The <var>channel</var> must be open.
Throw <code>guile-ssh-error</code> on error.  Return one of the following symbols:
<code>stdout</code>, <code>stderr</code>.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(channel-get-stream channel)
&rArr; 'stderr
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-channel_002dget_002dsession"></a>Scheme Procedure: <strong>channel-get-session</strong><em> channel</em></dt>
<dd><p>Get the session to which belongs the <var>channel</var>.  Throw
<code>guile-ssh-error</code> on an error.  Return the session.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dsend_002deof"></a>Scheme Procedure: <strong>channel-send-eof</strong><em> channel</em></dt>
<dd><p>Send an end of file (EOF) on the <var>channel</var>.  This action doesn&rsquo;t close the
<var>channel</var>; you may still read from it but not write.  Throw
<code>guile-ssh-error</code> on an error.  Return value is undefined.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ice-9 rdelim)
             ;; Guile-SSH modules.
             (ssh auth)
             (ssh popen)
             (ssh session)
             (ssh channel))

;; Make a session
(define s (make-session #:host &quot;example.org&quot;))

;; Connect to the server
(connect! s)

;; Authenticate
(userauth-agent! s)

;; Open a remote pipe to 'wc' command running on
;; the server.
(let ((p (open-remote-pipe s &quot;wc&quot; OPEN_BOTH)))

  ;; Send data to 'wc' command using the remote pipe.
  (display &quot;Hello Scheme World!&quot; p)

  ;; 'wc' reads data until EOF and writes its result
  ;; afterwards.
  (channel-send-eof p)

  ;; Read the 'wc' output.
  (read-line p))
&rArr; &quot;      0       3      19&quot;
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-channel_002deof_003f"></a>Scheme Procedure: <strong>channel-eof?</strong><em> channel</em></dt>
<dd><p>Return <code>#t</code> if remote has sent <acronym>EOF</acronym>, <code>#f</code> otherwise.  Throw
<code>guile-ssh-error</code> if the channel has been closed and freed.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dget_002dexit_002dstatus"></a>Scheme Procedure: <strong>channel-get-exit-status</strong><em> channel</em></dt>
<dd><p>Get the exit status of the <var>channel</var> (error code from the executed
instruction).  The <var>channel</var> must be open.  Return the exist status, or
<code>#f</code> if no exit status has been returned (yet).  Throw
<code>guile-ssh-error</code> on error.
</p></dd></dl>

<hr>
<a name="Port-Forwarding"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Channel-Management" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Channels" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tunnels" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Port-Forwarding-1"></a>
<h3 class="subsection">3.5.2 Port Forwarding</h3>

<a name="index-Port-forwarding"></a>

<p>Low-level API from <code>(ssh channel)</code> module to manage SSH port
forwarding. These procedures <strong>do not</strong> bind the ports and do not
automatically forward the content of a socket to the channel.  You should
either implement binding and data forwarding in your application or use the
tunnel API (see section <a href="#Tunnels">Guile-SSH tunnel API</a>)
</p>
<dl>
<dt><a name="index-channel_002dopen_002dforward"></a>Scheme Procedure: <strong>channel-open-forward</strong><em> channel [#:source-host=''localhost''] #:local-port #:remote-host [#:remote-port=local-port]</em></dt>
<dd><p>Open a (local) TCP/IP forwarding <var>channel</var>.  Connect to a
<var>remote-host</var> and <var>remote-port</var>, and use <var>source-host</var> and
<var>local-port</var> as origination of connections.
</p>
<p>The procedure returns one of the following symbols:
</p><dl compact="compact">
<dt>&lsquo;<samp>ok</samp>&rsquo;</dt>
<dd><p>Success.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>We are in the nonblocking mode and the call to be done again.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>An error occurred.
</p></dd>
</dl>

<p>The local port forwarding works as follows:
</p>
<div class="example">
<pre class="example">local-host               remote-host
,...............,        ,.................
:               :        :                :
:  [a browser]  :        : [a web server] :
:       |       :        :        A       :
:       |       :        :        |       :
:   port 8080   :        :     port 80    :
:       |       :        :        |       :
:       V       :        :        |       :
:  [SSH client]===========&gt;[SSH server]   :
:               :        :                :
'...............'        '................'
</pre></div>

<p>Where port 8080 is an arbitrary <var>local-port</var> and port 80 is a
<var>remote-port</var>.
</p>
<p>Also in our case, &ldquo;SSH client&rdquo; is an application that uses Guile-SSH and
calls <code>channel-open-forward</code>.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(channel-open-forward channel
                      #:local-port  8080
                      #:remote-host &quot;www.example.org&quot;
                      #:remote-port 80)
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-channel_002dlisten_002dforward"></a>Scheme Procedure: <strong>channel-listen-forward</strong><em> session [#:address=#f] [#:port=0]</em></dt>
<dd><p>Start a TCP/IP reverse (remote) port forwarding.  Send the &ldquo;tcpip-forward&rdquo;
global request using <var>session</var> to ask the server to begin listening for
inbound connections on the specified <var>address</var> and <var>port</var>.
</p>
<p>If <var>address</var> is not specified (or set to <code>#f</code>) then the server binds
all addresses on all protocol families supported by the server.  When 0 is
passed as a <var>port</var> then server allocates the next unprivileged port.
</p>
<p>The procedure returns two values: the first value is the result of the
operation, and the second value is the bound port number; if <var>port</var> was
set to 0 then the procedure returns the chosen port number.
</p>
<p>The result of the operation can be one of the following symbols:
</p><dl compact="compact">
<dt>&lsquo;<samp>ok</samp>&rsquo;</dt>
<dd><p>Success.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>We are in the nonblocking mode and the call to be done again.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>An error occurred.
</p></dd>
</dl>

<p>Reverse port forwarding looks as follows:
</p>
<div class="example">
<pre class="example">local-host                remote-host
,................,        ,.................
:                :        :                :
: [a web server] :        :  [a browser]   :
:        A       :        :       |        :
:        |       :        :       |        :
:     port 80    :        :   port 8080    :
:        |       :        :       |        :
:        |       :        :       V        :
:   [SSH client]&lt;===========[SSH server]   :
:                :        :                :
'................'        '................'
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-channel_002daccept_002dforward"></a>Scheme Procedure: <strong>channel-accept-forward</strong><em> session [timeout=0]</em></dt>
<dd><p>Accept an incoming TCP/IP forwarding channel and get information about
incoming connection.  Return two values: the first value is the incoming
channel, and the second value is a port number on which the connection was
issued.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dcancel_002dforward"></a>Scheme Procedure: <strong>channel-cancel-forward</strong><em> session address port</em></dt>
<dd><p>Send &ldquo;cancel-tcpip-forward&rdquo; global request to <var>session</var> to ask the
server to cancel a &ldquo;tcpip-forward&rdquo; request on the bound <var>address</var> and
<var>port</var>.
</p>
<p>The result of the operation can be one of the following symbols:
</p><dl compact="compact">
<dt>&lsquo;<samp>ok</samp>&rsquo;</dt>
<dd><p>Success.
</p></dd>
<dt>&lsquo;<samp>again</samp>&rsquo;</dt>
<dd><p>We are in the nonblocking mode and the call to be done again.
</p></dd>
<dt>&lsquo;<samp>error</samp>&rsquo;</dt>
<dd><p>An error occurred.
</p></dd>
</dl>

<p>Here&rsquo;s an example Guile program that uses <code>channel-cancel-forward</code> to
cancel reverse port forwarding on a server:
</p>
<div class="lisp">
<pre class="lisp">#!/usr/bin/guile \
-e main
!#

(use-modules (ssh session)
             (ssh auth)
             (ssh channel))

(define (main args)
  (let ((session (make-session #:user          &quot;alice&quot;
                               #:host          &quot;127.0.0.1&quot;
                               #:port          22
                               #:log-verbosity 'rare)))
    (connect! session)
    (userauth-agent! session)

    ;; Send &quot;tcpip-forward&quot; request to an SSH server
    (channel-listen-forward session #:address &quot;localhost&quot; #:port 12345)

    ;; Accept incoming reverse port forwarding requests with
    ;; 'channel-accept-forward' in some kind of loop...

    ;; Cancel the issued &quot;tcpip-forward&quot; request with
    ;; &quot;cancel-tcpip-forward&quot; request
    (channel-cancel-forward session &quot;localhost&quot; 12345)))
</pre></div>
</dd></dl>


<hr>
<a name="Tunnels"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Port-Forwarding" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Example" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tunnels-1"></a>
<h2 class="section">3.6 Tunnels</h2>

<a name="index-Tunnels"></a>

<p>The following procedures from <code>(ssh tunnel)</code> module are a high-level API
built upon the basic port forwarding facilities for managing port forwards.
</p>
<dl>
<dt><a name="index-make_002dtunnel"></a>Scheme Procedure: <strong>make-tunnel</strong><em> session [#:bind-address=''127.0.0.1''] #:port #:host [#:host-port=port] [#:reverse?=#f]</em></dt>
<dd><p>Make a new SSH tunnel using <var>session</var> from <var>bind-address</var> and
<var>port</var> to a <var>host</var> and <var>host-port</var>.
</p>
<p>The procedure is capable of creating both direct and reverse port forwarding
tunnels; the type of a tunnel is determined by <var>reverse?</var> argument.  If
<var>reverse?</var> is set to <code>#f</code> then a reverse port forwarding tunnel will
be created.
</p>
<p>Setting <var>reverse?</var> to <code>#t</code> changes the direction of the tunnel and a
reverse port forwarding tunnel will be created.  In this case a server
allocates a socket to listen to <var>port</var> on the remote side, and whenever a
connection is made to this port, the connection is forwarded over the secure
channel, and a connection is made to <var>host</var> and <var>host-port</var> from the
local machine.  <var>host</var> can be set to <code>#f</code> to tell the server to
listen on all addresses and known protocol families.  Setting a <var>port</var> to
0 tells the server to bind the first unprivileged port.
</p>
<p>The procedure does not binds ports nor transfers data to the port (in case of
reverse port forwarding), you should start port forwarding by means of the
procedures that operate on a &lt;tunnel&gt; object &ndash; e.g.  <code>start-forward</code> or
<code>call-with-ssh-forward</code>.
</p>
<p>Return a new tunnel object.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_003f"></a>Scheme Procedure: <strong>tunnel?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is an Guile-SSH tunnel, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dreverse_003f"></a>Scheme procedure: <strong>tunnel-reverse?</strong><em> x</em></dt>
<dd><p>Check if <var>x</var> is a reverse port forwarding tunnel.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dsession"></a>Scheme procedure: <strong>tunnel-session</strong><em> tunnel</em></dt>
<dd><p>Get a session associated with a <var>tunnel</var>.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dbind_002daddress"></a>Scheme Procedure: <strong>tunnel-bind-address</strong><em> tunnel</em></dt>
<dd><p>Get a source host of a <var>tunnel</var>.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dport"></a>Scheme Procedure: <strong>tunnel-port</strong><em> tunnel</em></dt>
<dd><p>Get a local port of a <var>tunnel</var>.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dhost"></a>Scheme Procedure: <strong>tunnel-host</strong><em> tunnel</em></dt>
<dd><p>Get a remote host of a <var>tunnel</var>.
</p></dd></dl>

<dl>
<dt><a name="index-tunnel_002dhost_002dport"></a>Scheme Procedure: <strong>tunnel-host-port</strong><em> tunnel</em></dt>
<dd><p>Get a remote port of a <var>tunnel</var>.
</p></dd></dl>

<dl>
<dt><a name="index-start_002dforward"></a>Scheme Procedure: <strong>start-forward</strong><em> tunnel</em></dt>
<dd><p>Start port forwarding on <var>tunnel</var>.  The procedure actually binds tunnel
ports and forwards data.
</p></dd></dl>

<dl>
<dt><a name="index-call_002dwith_002dssh_002dforward"></a>Scheme Procedure: <strong>call-with-ssh-forward</strong><em> tunnel proc</em></dt>
<dd><p>Open a new <var>tunnel</var> and start port forwarding. <var>proc</var> is called with
an open channel as an argument. All I/O on the channel will be forwarded to
the remote host and port of a <var>tunnel</var>. Return the result the <var>proc</var>
call.
</p>
<p>As a practical example, let&rsquo;s say you want to use
<a href="https://www.gnu.org/software/guile-rpc/">Guile-RPC</a> over SSH. Here&rsquo;s how
you can implement a using <code>call-with-ssh-forward</code>:
</p>
<div class="lisp">
<pre class="lisp">(let ((pid (primitive-fork)))
  (if (zero? pid)
      ;; Make a new SSH session, connect it and authenticate the user.
      (let* ((host    &quot;example.org&quot;)
             (user    &quot;alice&quot;)
             (session (make-session #:user user
                                    #:host host
                                    #:port 22
                                    #:log-verbosity 'nolog)))
        (connect! session)
        (userauth-agent! session)
        ;; Make a new SSH tunnel.
        (let ((tunnel (make-tunnel session
                                   #:port 12345
                                   ;; Guile-RPC server listens on 127.0.0.1
                                   ;; on the remote host.
                                   #:host &quot;127.0.0.1&quot;
                                   ;; Guile-RPC server port.
                                   #:host-port 6666)))
          ;; Start the forwarder loop.
          (start-forward tunnel)))
      ;; Parent process.
      (let ((sock (socket PF_INET SOCK_STREAM 0)))
      (dynamic-wind
        (const #t)
        (lambda ()
          (sleep 1)
          ;; Connect to the port that is listened to by the spawned process.
          (connect sock AF_INET
            (inet-pton AF_INET &quot;127.0.0.1&quot;)
            12345)

          ;; Make an RPC call using the SSH tunnel.
          (display (invoke-split-number 3.14 #x7777 sock))
          (newline))
        (lambda ()
          (close sock)
          (kill pid SIGTERM)
          (waitpid pid))))))
</pre></div>

<p>The full example of an RPC client that uses a SSH tunnel is in
&lsquo;<tt>$prefix/share/guile-ssh/examples/rpc</tt>&rsquo; directory.
</p></dd></dl>

<hr>
<a name="Example"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tunnels" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tunnels" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Remote-Pipes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.6.1 Example</h3>

<p>Here is a simple Guile program that connects to &ldquo;www.example.org&rdquo; and starts
port forwading from the local port 8080 to the port 80 on the remote host:
</p>
<div class="lisp">
<pre class="lisp">#!/usr/bin/guile \
-e main
!#

(use-modules (ssh session)
             (ssh auth)
             (ssh key)
             (ssh tunnel))

(define (main args)
  (let ((s (make-session #:user          &quot;alice&quot;
                         #:host          &quot;localhost&quot;
                         #:port          22
                         #:log-verbosity 'nolog))
        (k (private-key-from-file &quot;/home/alice/.ssh/id_rsa&quot;)))
    (connect! s)
    (userauth-public-key! s k)
    (let ((t (make-tunnel s
                          #:port      8080
                          #:host      &quot;www.example.org&quot;
                          #:host-port 80)))
      (start-forward t))))
</pre></div>


<hr>
<a name="Remote-Pipes"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Example" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Examples-2" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Remote-Pipes-1"></a>
<h2 class="section">3.7 Remote Pipes</h2>
<a name="index-remote-pipes"></a>

<p><code>(ssh popen)</code> provides API for working with remote pipes, akin to
<code>(ice-9 popen)</code> procedures (see <a href="guile.html#Pipes">Pipes</a> in <cite>The GNU Guile Reference Manual</cite>)
</p>
<p><var>mode</var> argument allows to specify what kind of pipe should be created.
Allowed values are: <code>OPEN_READ</code>, <code>OPEN_WRITE</code>, <code>OPEN_BOTH</code>.
</p>
<p>There is an additional value, <code>OPEN_PTY</code>, that allows to request a pseudo
terminal.  The terminal is needed to run such commands as <code>top</code>.  Thus,
to run <code>top</code> on the remote side you need to open a remote pipe with &quot;t&quot;
flag set.
</p>
<p><strong>Note</strong> that when a PTY is used, a server merges stderr stream with
stdout.
</p>
<p>Values of the aforementioned constants:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>OPEN_READ</samp>&rsquo;</dt>
<dd><p>      &ldquo;r&rdquo;
</p></dd>
<dt>&lsquo;<samp>OPEN_WRITE</samp>&rsquo;</dt>
<dd><p>      &ldquo;w&rdquo;
</p></dd>
<dt>&lsquo;<samp>OPEN_BOTH</samp>&rsquo;</dt>
<dd><p>      &ldquo;r+&rdquo;
</p></dd>
<dt>&lsquo;<samp>OPEN_PTY</samp>&rsquo;</dt>
<dd><p>      &ldquo;t&rdquo;
</p></dd>
</dl>

<dl>
<dt><a name="index-open_002dremote_002dpipe"></a>Scheme Procedure: <strong>open-remote-pipe</strong><em> session command mode</em></dt>
<dd><p>Execute a <var>command</var> on the remote host using a <var>session</var> with a pipe
to it.  Returns newly created channel port with the specified <var>mode</var>.
</p></dd></dl>

<dl>
<dt><a name="index-open_002dremote_002dpipe_002a"></a>Scheme Procedure: <strong>open-remote-pipe*</strong><em> session mode prog [args...]</em></dt>
<dd><p>Execute <var>prog</var> on the remote host with the given <var>args</var> using a
<var>session</var> with a pipe to it.  Returns newly created channel port with the
specified <var>mode</var>.
</p></dd></dl>

<dl>
<dt><a name="index-open_002dremote_002dinput_002dpipe"></a>Scheme Procedure: <strong>open-remote-input-pipe</strong><em> session command</em></dt>
<dt><a name="index-open_002dremote_002dinput_002dpipe_002a"></a>Scheme Procedure: <strong>open-remote-input-pipe*</strong><em> session prog [args...]</em></dt>
<dd><p>Equvalent to <code>open-remote-pipe</code> and <code>open-remote-pipe*</code> respectively
with mode <code>OPEN_READ</code>.
</p></dd></dl>

<dl>
<dt><a name="index-open_002dremote_002doutput_002dpipe"></a>Scheme Procedure: <strong>open-remote-output-pipe</strong><em> session command</em></dt>
<dt><a name="index-open_002dremote_002doutput_002dpipe_002a"></a>Scheme Procedure: <strong>open-remote-output-pipe*</strong><em> session prog [args...]</em></dt>
<dd><p>Equvalent to <code>open-remote-pipe</code> and <code>open-remote-pipe*</code> respectively
with mode <code>OPEN_WRITE</code>.
</p></dd></dl>

<hr>
<a name="Examples-2"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Remote-Pipes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Remote-Pipes" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-cases" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.7.1 Examples</h3>

<hr>
<a name="Simple-cases"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples-2" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples-2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Executing-a-command-with-a-pseudo-terminal" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.7.1.1 Simple cases</h4>

<p>Here&rsquo;s a self-explanatory little script that executes <code>uname -o</code> command
on the local host and prints the result:
</p>
<div class="lisp">
<pre class="lisp">#!/usr/bin/guile \
-e main -s
!#

(use-modules (ice-9 rdelim)             ; {read,write}-line
             ;; Guile-SSH
             (ssh session)
             (ssh auth)
             (ssh popen))               ; remote pipes

(define (main args)
  ;; Make a session with local machine and the current user.
  (let ((session (make-session #:host &quot;localhost&quot;)))

    ;; Connect the session and perform the authentication.
    (connect! session)
    (authenticate-server session)
    (userauth-agent! session)

    ;; Execute the command on the remote side and get the input pipe
    ;; to it.
    (let ((channel (open-remote-input-pipe session &quot;uname -o&quot;)))
      ;; Read and display the result.
      (write-line (read-line channel)))))
</pre></div>

<hr>
<a name="Executing-a-command-with-a-pseudo-terminal"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Simple-cases" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples-2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Controlling-the-pseudo-terminal-size" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.7.1.2 Executing a command with a pseudo terminal</h4>

<p>Surely we aren&rsquo;t limited to one-line outputs; for example, we can watch
<code>top</code> command executing on a remote side locally, by reading data from
the channel in a loop:
</p>
<div class="lisp">
<pre class="lisp">(define OPEN_PTY_READ (string-append OPEN_PTY OPEN_READ))

(let ((channel (open-remote-pipe* session OPEN_PTY_READ
                                  &quot;top&quot; &quot;-u avp&quot;)))
  (let r ((line (read-line channel)))
    (unless (eof-object? line)
      (write-line line)
      (r (read-line channel)))))
</pre></div>

<p>Or we can do the same, but this time with streams:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (srfi srfi-41)             ; streams
             (ssh session)
             (ssh auth)
             (ssh popen))

(define (pipe-&gt;stream p)
  (stream-let loop ((c (read-char p)))
    (if (eof-object? c)
        (begin
          (close-input-port p)
          stream-null)
        (stream-cons c (loop (read-char p))))))

(define OPEN_PTY_READ (string-append OPEN_PTY OPEN_READ))

(define (main args)
  (let ((s (make-session #:host &quot;example.org&quot;)))
    (connect! s)
    (userauth-agent! s)
    (let ((rs (pipe-&gt;stream (open-remote-pipe* s OPEN_PTY_READ
                                               &quot;top&quot; &quot;-u avp&quot;))))
      (stream-for-each display rs))))
</pre></div>

<hr>
<a name="Controlling-the-pseudo-terminal-size"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Executing-a-command-with-a-pseudo-terminal" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples-2" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Shell" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.7.1.3 Controlling the pseudo terminal size</h4>

<p>To set the size of a pseudo terminal, one may use <code>channel-set-pty-size!</code>
from <code>(ssh channel)</code>.  For example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh popen)
             (ssh auth)
             (ssh channel))

(define OPEN_PTY_READ (string-append OPEN_PTY OPEN_READ))

;; Opening of a Guile-SSH session goes here ...

(let ((p (open-remote-pipe* session OPEN_PTY_READ &quot;top&quot; &quot;-u avp&quot;)))
  (channel-set-pty-size! p 80 50)
  ;; Reading output from a port ...
  )
</pre></div>


<hr>
<a name="Shell"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Controlling-the-pseudo-terminal-size" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Logging" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Shell-1"></a>
<h2 class="section">3.8 Shell</h2>

<a name="index-secure-shell"></a>

<p>A high-level interface to a remote shell built upon <code>(ssh popen)</code> API.
The procedures described in this section uses GNU Coreutils on the remote side
and may depend on some other packages; see the notes for each procedure.
</p>
<dl>
<dt><a name="index-rexec"></a>Scheme Procedure: <strong>rexec</strong><em> session command</em></dt>
<dd><p>Execute a <var>command</var> on the remote side.  Return two values: list of output
lines returned by a <var>command</var> and its exit code.
</p></dd></dl>

<dl>
<dt><a name="index-which"></a>Scheme Procedure: <strong>which</strong><em> session program-name</em></dt>
<dd><p>Check if a <var>program-name</var> is available on a remote side.  Return two
values: a path to a command if it is found and a return code.
</p>
<p>The procedure uses shell build-in command <code>which</code> on the remote side.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh session)
             (ssh auth)
             (ssh shell))

(let ((s (make-session #:host &quot;example.org&quot;)))
  (connect! s)
  (userauth-agent! s)
  (which s &quot;guile&quot;))
&rArr; (&quot;/usr/bin/guile&quot;)
&rArr; 0
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-command_002davailable_003f"></a>Scheme Procedure: <strong>command-available?</strong><em> session command</em></dt>
<dd><p>Check if a <var>command</var> is available on a remote machine represented by a
<var>session</var>.
</p></dd></dl>

<dl>
<dt><a name="index-pgrep"></a>Scheme Procedure: <strong>pgrep</strong><em> session pattern [#:full?=#f] [#:use-guile?=#f]</em></dt>
<dd><p>Search for a process with a <var>pattern</var> cmdline on a machine represented by
a <var>session</var>.  Return two values: a list of PIDs and a return code.
</p>
<p>The procedure uses a <code>pgrep</code> from procps package on the remote side
when <var>use-guile?</var> is set to <code>#f</code> (this is by default.)
</p>
<p>When <var>use-guile?</var> is set to <code>#t</code>, the procedure will execute a Scheme
code using GNU Guile on the remote side to kill processes.
</p>
</dd></dl>

<dl>
<dt><a name="index-pkill"></a>Scheme Procedure: <strong>pkill</strong><em> session pattern [#:full?=#f] [#:signal=SIGTERM] [#:use-guile?=#f]</em></dt>
<dd>
<p>Send a <var>signal</var> to a process which name matches to <var>pattern</var> on a
remote machine represented by a <var>session</var>. Return two values: a list of
PIDs of killed processes and a return code.
</p>
<p>The <var>signal</var> must be a numeric value as for Guile <code>kill</code> procedure.
</p>
<p>The procedure uses a <code>pkill</code> from procps package on the remote side
when <var>use-guile?</var> is set to <code>#f</code> (this is by default.)
</p>
<p>When <var>use-guile?</var> is set to <code>#t</code>, the procedure will execute a Scheme
code using GNU Guile on the remote side to kill processes.
</p></dd></dl>

<dl>
<dt><a name="index-loadavg"></a>Scheme Procedure: <strong>loadavg</strong><em> session</em></dt>
<dd><p>Get average load of a host using a <var>session</var>.  Return a list of five
elements as described in proc(5) man page.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh session)
             (ssh auth)
             (ssh shell))

(let ((s (make-session #:host &quot;example.org&quot;)))
  (connect! s)
  (userauth-agent! s)
  (loadavg s))
&rArr; (&quot;0.01&quot; &quot;0.05&quot; &quot;0.10&quot; &quot;4/1927&quot; &quot;242011&quot;)
</pre></div>

</dd></dl>

<hr>
<a name="Logging"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Shell" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Version" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Logging-1"></a>
<h2 class="section">3.9 Logging</h2>

<a name="index-logging"></a>

<p>The <code>(ssh log)</code> module provides procedures to control the libssh logging
facilities.
</p>
<dl>
<dt><a name="index-_0025default_002dlog_002dprinter"></a>Scheme Procedure: <strong>%default-log-printer</strong><em> priority function message userdata</em></dt>
<dd><p>Default callback for printing log messages to the current error port.  The
procedure comments out log messages with &ldquo;;;; &ldquo; to make it easier to
distinguish libssh traces from Guile-SSH messages in REPL mode.
</p>
<p>This callback is set by default.
</p></dd></dl>

<dl>
<dt><a name="index-_0025default_002dlibssh_002dlog_002dprinter"></a>Scheme Procedure: <strong>%default-libssh-log-printer</strong><em> priority function message userdata</em></dt>
<dd><p>The procedure makes log messages in the same format as the libssh default log
formatter.
</p></dd></dl>

<dl>
<dt><a name="index-current_002dlogging_002dcallback"></a>Scheme Procedure: <strong>current-logging-callback</strong></dt>
<dd><p>Return the current logging callback.  Returns a procedure or <code>#f</code> if the
callback is not set.
</p></dd></dl>

<dl>
<dt><a name="index-set_002dlogging_002dcallback_0021"></a>Scheme Procedure: <strong>set-logging-callback!</strong><em> callback</em></dt>
<dd><p>Change the current logging callback to <var>callback</var>.  The <var>callback</var>
must be a procedure that takes four arguments: priority of a log message, a
function name, the message and a custom user data.
</p>
<p>Throw <code>guile-ssh-error</code> on an error.  Return value is undefined.
</p>
<p>Here is an example of a custom callback which indents each log message
according to its priority:
</p>
<div class="lisp">
<pre class="lisp">(define (pretty-log-printer priority function message userdata)
  (do ((i 1 (1+ i)))
      ((&gt; i priority))
    (display &quot;  &quot; (current-error-port)))
  (format (current-error-port) &quot;[~a] ~a~%&quot;
          (strftime &quot;%Y-%m-%dT%H:%M:%S%z&quot; (localtime (current-time)))
          message))

(set-logging-callback! pretty-log-printer)
</pre></div>

<p>You can restore the default callback as the follows:
</p>
<div class="lisp">
<pre class="lisp">(set-logging-callback! %default-log-printer)
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-set_002dlog_002duserdata_0021"></a>Scheme Procedure: <strong>set-log-userdata!</strong><em> user-data</em></dt>
<dd><p>Set an arbitrary <var>user-data</var> to be passed to a logging callback.
Throw <code>guile-ssh-error</code> on an error.  Return value is undefined.
</p>
<p>By default the user data is set to <code>#f</code>.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dlog_002duserdata"></a>Scheme Procedure: <strong>get-log-userdata</strong></dt>
<dd><p>Get the current user data.
</p></dd></dl>

<dl>
<dt><a name="index-format_002dlog"></a>Scheme Procedure: <strong>format-log</strong><em> priority procedure-name format-string arg ...</em></dt>
<dd><p>Write a formatted message to the libssh log with the given <var>priority</var>.
Return value is undefined.
</p>
<p>Syntax for the <var>format-string</var> is the same as for <code>format</code> procedure.
</p>
<p><var>priority</var> is expected to be a symbol.  Acceptable priority levels are:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>nolog</samp>&rsquo;</dt>
<dd><p>The message will be printed even if the logging is disabled
</p></dd>
<dt>&lsquo;<samp>rare</samp>&rsquo;</dt>
<dd><p>Rare and noteworthy events
</p></dd>
<dt>&lsquo;<samp>protocol</samp>&rsquo;</dt>
<dd><p>High level protocol information
</p></dd>
<dt>&lsquo;<samp>packet</samp>&rsquo;</dt>
<dd><p>Lower level protocol infomations, packet level
</p></dd>
<dt>&lsquo;<samp>functions</samp>&rsquo;</dt>
<dd><p>Function path
</p></dd>
</dl>

<p>Note that the procedure uses the provided logging callback directly, bypassing
the libssh logging facilities.
</p>
</dd></dl>

<dl>
<dt><a name="index-set_002dlog_002dverbosity_0021"></a>Scheme Procedure: <strong>set-log-verbosity!</strong><em> verbosity</em></dt>
<dd><p>Set the global log verbosity to a <var>verbosity</var>.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p>
<p><var>verbosity</var> is expected to be one of the following symbols:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>nolog</samp>&rsquo;</dt>
<dd><p>The message will be printed even if the logging is disabled
</p></dd>
<dt>&lsquo;<samp>rare</samp>&rsquo;</dt>
<dd><p>Rare and noteworthy events
</p></dd>
<dt>&lsquo;<samp>protocol</samp>&rsquo;</dt>
<dd><p>High level protocol information
</p></dd>
<dt>&lsquo;<samp>packet</samp>&rsquo;</dt>
<dd><p>Lower level protocol infomations, packet level
</p></dd>
<dt>&lsquo;<samp>functions</samp>&rsquo;</dt>
<dd><p>Function path
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-get_002dlog_002dverbosity"></a>Scheme Procedure: <strong>get-log-verbosity</strong></dt>
<dd><p>Get global log verbosity value.
</p></dd></dl>


<hr>
<a name="Version"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Logging" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Servers" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Version-1"></a>
<h2 class="section">3.10 Version</h2>

<a name="index-versions"></a>

<p>The <code>(ssh version)</code> module provides functions that is used for
getting information about current versions.
</p>
<dl>
<dt><a name="index-get_002dlibssh_002dversion"></a>Scheme Procedure: <strong>get-libssh-version</strong></dt>
<dd><p>Get version of the libssh.  Returns libssh version as a string in the
follwing format:
</p>
<div class="example">
<pre class="example">&lt;version&gt; ::= &lt;major&gt; &quot;.&quot; &lt;minor&gt; &quot;.&quot; &lt;micro&gt;
</pre></div>

<p>For example, &lsquo;<samp>0.5.2</samp>&rsquo;.
</p></dd></dl>

<dl>
<dt><a name="index-_0025get_002dlibssh_002dversion"></a>Scheme Procedure: <strong>%get-libssh-version</strong></dt>
<dd><p>Low-level procedure that returns a version string in libssh format,
eg. &quot;0.6.3/openssl/zlib&quot;.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dcrypto_002dlibrary"></a>Scheme Procedure: <strong>get-crypto-library</strong></dt>
<dd><p>Get cryptographic library name with which libssh was compiled.  Possible
values are: <code>'openssl</code>, <code>'gnutls</code>.
</p></dd></dl>

<dl>
<dt><a name="index-zlib_002dsupport_003f"></a>Scheme Procedure: <strong>zlib-support?</strong></dt>
<dd><p>Return <code>#t</code> if libssh was compiled wit zlib support, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-get_002dlibrary_002dversion"></a>Scheme Procedure: <strong>get-library-version</strong></dt>
<dd><p>Get version of the Guile-SSH.
</p></dd></dl>


<hr>
<a name="Servers"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Version" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Messages" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Servers-1"></a>
<h2 class="section">3.11 Servers</h2>

<a name="index-servers"></a>
<a name="index-server"></a>

<p>The <code>(ssh server)</code> module provides facilities for creation and
managing of Guile-SSH servers.
</p>
<dl>
<dt><a name="index-server_003f"></a>Scheme Procedure: <strong>server?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a Guile-SSH server, <code>#f</code>
otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-_0025make_002dserver"></a>Scheme Procedure: <strong>%make-server</strong></dt>
<dd><p>Make a new Guile-SSH server.
</p></dd></dl>

<dl>
<dt><a name="index-make_002dserver"></a>Scheme Procedure: <strong>make-server</strong><em> [keywords]</em></dt>
<dd><p>Make a new Guile-SSH server with the specified configuration specified
by keywords.  Return a new Guile-SSH server.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((s (make-server #:bindport      12345
                      #:rsakey        &quot;/home/bob/.ssh/id_rsa&quot;
                      #:log-verbosity 'nolog)))
  ...)
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-server_002dset_0021"></a>Scheme Procedure: <strong>server-set!</strong><em> server option value</em></dt>
<dd><p>Set a <var>option</var> to <var>value</var> for Guile-SSH <var>server</var>.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p>
<p>Here is the description of available options.  The description is
based on libssh documentation:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>bindaddr</samp>&rsquo;</dt>
<dd><p>Set the bind address for the <var>server</var>.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>bindport</samp>&rsquo;</dt>
<dd><p>Set the bind port for the <var>server</var>, default is 22.
</p>
<p>Expected type of <var>value</var>: number.
</p></dd>
<dt>&lsquo;<samp>hostkey</samp>&rsquo;</dt>
<dd><p>Set the <var>server</var> public key type: &ldquo;ssh-rsa&rdquo; or &ldquo;ssh-dss&rdquo;.
</p>
<p><strong>libssh 0.7 note:</strong> you should pass a path to an ssh key for this
option.  Only one key from per key type (RSA, DSA, ECDSA) is allowed in an
server at a time, and later calls to <code>server-set!</code> with this option for
the same key type will override prior calls.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>dsakey</samp>&rsquo;</dt>
<dd><p>Set the path to the <acronym>SSH</acronym> host <acronym>DSA</acronym> key.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>rsakey</samp>&rsquo;</dt>
<dd><p>Set the path to the <acronym>SSH</acronym> host <acronym>RSA</acronym> key.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>banner</samp>&rsquo;</dt>
<dd><p>Set the <var>server</var> banner sent to clients.
</p>
<p>Expected type of <var>value</var>: string.
</p></dd>
<dt>&lsquo;<samp>log-verbosity</samp>&rsquo;</dt>
<dd><p>Set the logging verbosity.  Possible values:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>nolog</samp>&rsquo;</dt>
<dd><p>No logging at all
</p></dd>
<dt>&lsquo;<samp>rare</samp>&rsquo;</dt>
<dd><p>Only rare and noteworthy events
</p></dd>
<dt>&lsquo;<samp>protocol</samp>&rsquo;</dt>
<dd><p>High level protocol information
</p></dd>
<dt>&lsquo;<samp>packet</samp>&rsquo;</dt>
<dd><p>Lower level protocol infomations, packet level
</p></dd>
<dt>&lsquo;<samp>functions</samp>&rsquo;</dt>
<dd><p>Every function path
</p></dd>
</dl>

<p>Expected type of <var>value</var>: symbol.
</p></dd>
<dt>&lsquo;<samp>blocking-mode</samp>&rsquo;</dt>
<dd><p>Set the <var>server</var> to blocking/nonblocking mode according to
<var>value</var>.  The <var>value</var> is expected to be <code>#t</code> or
<code>#f</code>.
</p>
<p>Expected type of <var>value</var>: boolean.
</p></dd>
</dl>

</dd></dl>

<dl>
<dt><a name="index-server_002dget"></a>Scheme Procedure: <strong>server-get</strong><em> server option</em></dt>
<dd><p>Get value of <var>option</var> for Guile-SSH <var>server</var>.  Return <var>option</var>
value, or <code>#f</code> if the <var>option</var> does not set.  Throw
<code>guile-ssh-error</code> on error.
</p></dd></dl>

<dl>
<dt><a name="index-server_002dlisten"></a>Scheme Procedure: <strong>server-listen</strong><em> server</em></dt>
<dd><p>Start listening to the socket.  Throw <code>guile-ssh-error</code> on error.
Return value undefined.
</p></dd></dl>

<dl>
<dt><a name="index-server_002daccept"></a>Scheme Procedure: <strong>server-accept</strong><em> server</em></dt>
<dd><p>Accept an incoming <acronym>SSH</acronym> connection to the <var>server</var>.
Return a new Guile-SSH session.  Throw <code>guile-ssh-error</code> on error.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(let ((session (catch 'guile-ssh-error
                 (lambda ()
                   (server-accept server))
                 (lambda (key . args)
                   ;; Handle error
                   #f))))
  ...)
</pre></div>

<p>One of the possible causes of errors might be that your server has no
access to host keys.
</p>
<p>If you get an exception and it shows no cause of the error then try to
set <code>log-verbosity</code> to a value other than <code>nolog</code> (e.g. to
<code>rare</code>, see <code>server-set!</code> above) and check printouts from
the libssh.
</p></dd></dl>

<dl>
<dt><a name="index-server_002dhandle_002dkey_002dexchange"></a>Scheme Procedure: <strong>server-handle-key-exchange</strong><em> session</em></dt>
<dd><p>Handle key exchange for a <var>session</var> and setup encryption.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-server_002dmessage_002dget"></a>Scheme Procedure: <strong>server-message-get</strong><em> session</em></dt>
<dd><p>Get a message from a SSH client (see section <a href="#Messages">Messages</a>).  Return a new
Guile-SSH message, or <code>#f</code> on error.
</p></dd></dl>


<hr>
<a name="Messages"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Servers" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Handling" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Messages-1"></a>
<h2 class="section">3.12 Messages</h2>

<a name="index-talking-to-a-SSH-client"></a>
<a name="index-message"></a>

<p>The <code>(ssh message)</code> module provides procedures for handling of
Guile-SSH messages.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
<tr><td align="left" valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">
</td></tr>
</table>

<hr>
<a name="Message-Handling"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Messages" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Messages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Parsing-of-Requests" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Messages-Handling"></a>
<h3 class="subsection">3.12.1 Messages Handling</h3>

<p>A message is an object that represents a single request to a Guile-SSH
server.  Basically the server handles requests in some loop in which
it accepts messages with <code>server-message-get</code> procedure
(see section <a href="#Servers">Servers</a>), handles the received request and replies to the
message.
</p>
<dl>
<dt><a name="index-message_003f"></a>Scheme Procedure: <strong>message?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> a Guile-SSH message, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dreply_002ddefault"></a>Scheme Procedure: <strong>message-reply-default</strong><em> message</em></dt>
<dd><p>Reply with <var>SSH_MSG_UNIMPLEMENTED</var>.  Throw <code>guile-ssh-error</code>
on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dreply_002dsuccess"></a>Scheme Procedure: <strong>message-reply-success</strong><em> message [args]</em></dt>
<dd><p>Reply &ldquo;success&rdquo; to the <var>message</var>.  This procedure is a
convenient wrapper for other <code>*-reply-success</code> procedures (see
below).  The right procedure to use will be selected depending on a
type of the <code>message</code>.  The procedure may take additional
argument <code>'partial</code> for that changes reply to authentication
request, and a <code>bound-port</code> for a global request.
</p>
<p>Throw an exception on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dservice_002dreply_002dsuccess"></a>Scheme Procedure: <strong>message-service-reply-success</strong><em> message</em></dt>
<dd><p>Reply with &ldquo;success&rdquo; status on the service-request <var>message</var>.
Throw <code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dauth_002dreply_002dsuccess"></a>Scheme Procedure: <strong>message-auth-reply-success</strong><em> message partial?</em></dt>
<dd><p>Reply with &ldquo;success&rdquo; on the auth-request <var>message</var>.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dchannel_002drequest_002dreply_002dsuccess"></a>Scheme Procedure: <strong>message-channel-request-reply-success</strong><em> message</em></dt>
<dd><p>Reply &ldquo;success&rdquo; on a channel-request <var>message</var>.
Throw <code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dglobal_002drequest_002dreply_002dsuccess"></a>Scheme Procedure: <strong>message-global-request-reply-success</strong><em> message bound-port</em></dt>
<dd><p>Reply &ldquo;success&rdquo; on a global request <var>message</var>.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dauth_002dreply_002dpublic_002dkey_002dok"></a>Scheme Procedure: <strong>message-auth-reply-public-key-ok</strong><em> message</em></dt>
<dd><p>Reply &ldquo;OK&rdquo; on the public key auth-request <var>message</var>.  Throw
<code>guile-ssh-error</code> on error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dchannel_002drequest_002dopen_002dreply_002daccept"></a>Scheme Procedure: <strong>message-channel-request-open-reply-accept</strong><em> message</em></dt>
<dd><p>Accept open-channel request.  Return a new Guile-SSH channel, or
<code>#f</code> on error.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dget_002dtype"></a>Scheme Procedure: <strong>message-get-type</strong><em> message</em></dt>
<dd><p>Get type of the <var>message</var> in the following format:
</p>
<div class="example">
<pre class="example">&lt;msg-type&gt; = &quot;'(&quot; &lt;type&gt; [&lt;WSP&gt; &lt;subtype&gt;] &quot;)&quot;
</pre></div>

<p>The procedure returns <code>#f</code> on error.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(message-get-type msg)
&rArr; '(request-auth auth-method-none)
</pre></div>

<p>Possible types:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>request-auth</samp>&rsquo;</dt>
<dd><p>Subtypes:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>auth-method-unknown</samp>&rsquo;</dt>
<dt>&lsquo;<samp>auth-method-none</samp>&rsquo;</dt>
<dt>&lsquo;<samp>auth-method-password</samp>&rsquo;</dt>
<dt>&lsquo;<samp>auth-method-publickey</samp>&rsquo;</dt>
<dt>&lsquo;<samp>auth-method-hostbased</samp>&rsquo;</dt>
<dt>&lsquo;<samp>auth-method-interactive</samp>&rsquo;</dt>
</dl>

</dd>
<dt>&lsquo;<samp>request-channel-open</samp>&rsquo;</dt>
<dd><p>Subtypes:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>channel-unknown</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-session</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-direct-tcpip</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-forwarded-tcpip</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-x11</samp>&rsquo;</dt>
</dl>

</dd>
<dt>&lsquo;<samp>request-channel</samp>&rsquo;</dt>
<dd><p>Subtypes:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>channel-request-unknown</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-pty</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-exec</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-shell</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-env</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-subsystem</samp>&rsquo;</dt>
<dt>&lsquo;<samp>channel-request-window-change</samp>&rsquo;</dt>
</dl>

</dd>
<dt>&lsquo;<samp>request-service</samp>&rsquo;</dt>
<dt>&lsquo;<samp>request-global</samp>&rsquo;</dt>
<dd><p>Subtypes:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>global-request-unknown</samp>&rsquo;</dt>
<dt>&lsquo;<samp>global-request-tcpip-forward</samp>&rsquo;</dt>
<dt>&lsquo;<samp>global-request-cancel-tcpip-forward</samp>&rsquo;</dt>
</dl>

</dd>
</dl>
</dd></dl>

<dl>
<dt><a name="index-message_002dget_002dreq"></a>Scheme Procedure: <strong>message-get-req</strong><em> message</em></dt>
<dd><p>Get a request object from the <var>message</var>.  Returns a new request
object (see section <a href="#Parsing-of-Requests">Parsing of Requests</a>).  Throw <code>guile-ssh-error</code> on
error.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dauth_002dset_002dmethods_0021"></a>Scheme Procedure: <strong>message-auth-set-methods!</strong><em> message methods-list</em></dt>
<dd><p>Set authentication methods to <var>methods-list</var>.  Possible methods
are: <code>password</code>, <code>public-key</code>, <code>interactive</code>,
<code>host-based</code>.  Throw <code>guile-ssh-error</code> on error.  Return
value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-message_002dget_002dsession"></a>Scheme Procedure: <strong>message-get-session</strong><em> message</em></dt>
<dd><p>Get the session from which the <var>message</var> was received.  Return the
session.
</p></dd></dl>

<hr>
<a name="Parsing-of-Requests"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Message-Handling" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Messages" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Parsing-of-Requests-1"></a>
<h3 class="subsection">3.12.2 Parsing of Requests</h3>

<a name="index-handling-of-requests"></a>
<a name="index-request"></a>

<dl>
<dt><a name="index-service_002dreq_003aservice"></a>Scheme Procedure: <strong>service-req:service</strong><em> request</em></dt>
<dd><p>Get service name from a service <var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-channel_002dopen_002dreq_003aorig"></a>Scheme Procedure: <strong>channel-open-req:orig</strong><em> request</em></dt>
<dt><a name="index-channel_002dopen_002dreq_003aorig_002dport"></a>Scheme Procedure: <strong>channel-open-req:orig-port</strong><em> request</em></dt>
<dt><a name="index-channel_002dopen_002dreq_003adest"></a>Scheme Procedure: <strong>channel-open-req:dest</strong><em> request</em></dt>
<dt><a name="index-channel_002dopen_002dreq_003adest_002dport"></a>Scheme Procedure: <strong>channel-open-req:dest-port</strong><em> request</em></dt>
<dd><p>Get originator, originator-port, destination and destination-port from
the channel-open <var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-auth_002dreq_003auser"></a>Scheme Procedure: <strong>auth-req:user</strong><em> request</em></dt>
<dt><a name="index-auth_002dreq_003apassword"></a>Scheme Procedure: <strong>auth-req:password</strong><em> request</em></dt>
<dt><a name="index-auth_002dreq_003apubkey"></a>Scheme Procedure: <strong>auth-req:pubkey</strong><em> request</em></dt>
<dt><a name="index-auth_002dreq_003apubkey_002dstate"></a>Scheme Procedure: <strong>auth-req:pubkey-state</strong><em> request</em></dt>
<dd><p>Get user, password, public key and public key state from the auth
<var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-pty_002dreq_003aterm"></a>Scheme Procedure: <strong>pty-req:term</strong><em> request</em></dt>
<dt><a name="index-pty_002dreq_003awidth"></a>Scheme Procedure: <strong>pty-req:width</strong><em> request</em></dt>
<dt><a name="index-pty_002dreq_003aheight"></a>Scheme Procedure: <strong>pty-req:height</strong><em> request</em></dt>
<dt><a name="index-pty_002dreq_003apxwidth"></a>Scheme Procedure: <strong>pty-req:pxwidth</strong><em> request</em></dt>
<dt><a name="index-pty_002dreq_003apxheight"></a>Scheme Procedure: <strong>pty-req:pxheight</strong><em> request</em></dt>
<dd><p>Get terminal, terminal width, terminal height, terminal pxwidth and
terminal pxheight from the <acronym>PTY</acronym> <var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-env_002dreq_003aname"></a>Scheme Procedure: <strong>env-req:name</strong><em> request</em></dt>
<dt><a name="index-env_002dreq_003avalue"></a>Scheme Procedure: <strong>env-req:value</strong><em> request</em></dt>
<dd><p>Get environment variable name and its value from the environment
<var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-exec_002dreq_003acmd"></a>Scheme Procedure: <strong>exec-req:cmd</strong><em> request</em></dt>
<dd><p>Get a command from the exec <var>request</var>.
</p></dd></dl>

<dl>
<dt><a name="index-global_002dreq_003aaddr"></a>Scheme Procedure: <strong>global-req:addr</strong><em> request</em></dt>
<dt><a name="index-global_002dreq_003aport"></a>Scheme Procedure: <strong>global-req:port</strong><em> request</em></dt>
<dd><p>Get address and port from the global <var>request</var>.
</p></dd></dl>


<hr>
<a name="SFTP"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Parsing-of-Requests" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP-session" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="SFTP-1"></a>
<h2 class="section">3.13 SFTP</h2>

<a name="index-SFTP"></a>
<a name="index-file-transfer"></a>

<p>The <code>(ssh sftp)</code> module provides procedures for working with SFTP.
</p>
<hr>
<a name="SFTP-session"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dLevel-API" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.13.1 SFTP session</h3>

<dl>
<dt><a name="index-make_002dsftp_002dsession"></a>Scheme Procedure: <strong>make-sftp-session</strong><em> ssh-session</em></dt>
<dd><p>Make a new SFTP session using a <var>ssh-session</var>, initialize the session with
a server.  Return initialized SFTP session or throw <code>guile-ssh-error</code>
exception on an error.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dsession_003f"></a>Scheme Procedure: <strong>sftp-session?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a SFTP session, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dget_002dsession"></a>Scheme Procedure: <strong>sftp-get-session</strong><em> sftp-session</em></dt>
<dd><p>Get the parent SSH session for a <var>sftp-session</var>.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dget_002derror"></a>Scheme Procedure: <strong>sftp-get-error</strong><em> sftp-session</em></dt>
<dd><p>Get the last SFTP error from a <var>sftp-session</var>.  Return the error name as a
symbol, or throw <code>guile-ssh-error</code> on if an error occurred in the
procedure itself.
</p>
<p>The procedure returns one of the following values:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>fx-ok</samp>&rsquo;</dt>
<dd><p>No error.
</p></dd>
<dt>&lsquo;<samp>fx-eof</samp>&rsquo;</dt>
<dd><p>End-of-file encountered.
</p></dd>
<dt>&lsquo;<samp>fx-no-such-file</samp>&rsquo;</dt>
<dd><p>File doesn&rsquo;t exist.
</p></dd>
<dt>&lsquo;<samp>fx-permission-denied</samp>&rsquo;</dt>
<dd><p>Permission denied.
</p></dd>
<dt>&lsquo;<samp>fx-failure</samp>&rsquo;</dt>
<dd><p>Generic failure.
</p></dd>
<dt>&lsquo;<samp>fx-bad-message</samp>&rsquo;</dt>
<dd><p>Garbage received from the server.
</p></dd>
<dt>&lsquo;<samp>fx-no-connection</samp>&rsquo;</dt>
<dd><p>No connection has been set up.
</p></dd>
<dt>&lsquo;<samp>fx-connection-lost</samp>&rsquo;</dt>
<dd><p>There was a connection, but we lost it.
</p></dd>
<dt>&lsquo;<samp>fx-op-unsupported</samp>&rsquo;</dt>
<dd><p>Operation not supported by the server.
</p></dd>
<dt>&lsquo;<samp>fx-invalid-handle</samp>&rsquo;</dt>
<dd><p>Invalid file handle.
</p></dd>
<dt>&lsquo;<samp>fx-no-such-path</samp>&rsquo;</dt>
<dd><p>No such file or directory path exists.
</p></dd>
<dt>&lsquo;<samp>fx-file-already-exist</samp>&rsquo;</dt>
<dd><p>An attempt to create an already existing file or directory has been made.
</p></dd>
<dt>&lsquo;<samp>fx-write-protect</samp>&rsquo;</dt>
<dd><p>We are trying to write on a write-protected filesystem.
</p></dd>
<dt>&lsquo;<samp>fx-no-media</samp>&rsquo;</dt>
<dd><p>No media in remote drive.
</p></dd>
</dl>
</dd></dl>

<dl>
<dt><a name="index-sftp_002dmkdir"></a>Scheme Procedure: <strong>sftp-mkdir</strong><em> sftp-session dirname [mode=#o777]</em></dt>
<dd><p>Create a directory <var>dirname</var> using a <var>sftp-session</var> with a <var>mode</var>.
If the <var>mode</var> is omitted, the current umask value is used.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002drmdir"></a>Scheme Procedure: <strong>sftp-rmdir</strong><em> sftp-session dirname</em></dt>
<dd><p>Remove a directory <var>dirname</var>.  Throw <code>guile-ssh-error</code> on an error.
Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dmv"></a>Scheme Procedure: <strong>sftp-mv</strong><em> sftp-session source dest</em></dt>
<dd><p>Move or rename a file <var>source</var> into a <var>dest</var>.  Throw
<code>guile-ssh-error</code> on an error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dsymlink"></a>Scheme Procedure: <strong>sftp-symlink</strong><em> sftp-session target dest</em></dt>
<dd><p>Create a symbolic link to a <var>target</var> in a <var>dest</var>.  Throw
<code>guile-ssh-error</code> on an error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dreadlink"></a>Scheme Procedure: <strong>sftp-readlink</strong><em> sftp-session path</em></dt>
<dd><p>Read the value of a symbolic link pointed by a <var>path</var>.  Return the value
or <code>#f</code> on an error.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dchmod"></a>Scheme Procedure: <strong>sftp-chmod</strong><em> sftp-session filename mode</em></dt>
<dd><p>Change permissions of a remote <var>filename</var> using <var>sftp-session</var>.
Permissions are set to <code>mode &amp; ~umask</code>.  Throw <code>guile-ssh-error</code> on
an error.  Return value is undefined.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dunlink"></a>Scheme Procedure: <strong>sftp-unlink</strong><em> sftp-session filename</em></dt>
<dd><p>Unlink (delete) a remote <var>filename</var> using <var>sftp-session</var>.  Throw
<code>guile-ssh-error</code> on an error.  Return value is undefined.
</p></dd></dl>

<hr>
<a name="Low_002dLevel-API"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP-session" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP-session" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP-file" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.13.1.1 Low-Level API</h4>

<dl>
<dt><a name="index-_0025make_002dsftp_002dsession"></a>Scheme Procedure: <strong>%make-sftp-session</strong><em> ssh-session</em></dt>
<dd><p>Make a new SFTP session using a <var>ssh-session</var> without initialization of
the session with a server.  Throw <code>guile-ssh-error</code> exception on an
error.
</p>
<p>Note that you should call <code>%sftp-init</code> on the returned SFTP session before
using it.
</p></dd></dl>

<dl>
<dt><a name="index-_0025sftp_002dinit"></a>Scheme Procedure: <strong>%sftp-init</strong><em> sftp-session</em></dt>
<dd><p>Initialize a <var>sftp-session</var> with the server.  Throw <code>guile-ssh-error</code>
exception on an error, return value is undefined.
</p></dd></dl>

<hr>
<a name="SFTP-file"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dLevel-API" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-operations-on-remote-files" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.13.2 SFTP file</h3>

<p>Remote files are represented as regular Guile ports that allow random access
(see <a href="guile.html#Input-and-Output">Input and Output</a> in <cite>The GNU Guile Reference Manual</cite>.)
</p>
<dl>
<dt><a name="index-sftp_002dopen"></a>Scheme Procedure: <strong>sftp-open</strong><em> sftp-session filename flags [mode=#o666]</em></dt>
<dd><p>Open a remote <var>filename</var> using an <var>sftp-session</var>, return an open file
port.  Throw <code>guile-ssh-error</code> on an error.
</p></dd></dl>

<dl>
<dt><a name="index-sftp_002dfile_003f"></a>Scheme Procedure: <strong>sftp-file?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is an SFTP file port, <code>#f</code> otherwise.
</p></dd></dl>

<hr>
<a name="High_002dlevel-operations-on-remote-files"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP-file" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#SFTP" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Distributed-Forms" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.13.3 High-level operations on remote files</h3>

<dl>
<dt><a name="index-call_002dwith_002dremote_002dinput_002dfile"></a>Scheme Procedure: <strong>call-with-remote-input-file</strong><em> sftp-session filename proc</em></dt>
<dd><p>Call a <var>proc</var> with a remote file port opened for input using an
<var>sftp-session</var>.  <var>proc</var> should be a procedure of one argument,
<var>filename</var> should be a string naming a file.  The behaviour is unspecified
if a file already exists.
</p>
<p>The procedure calls <var>proc</var> with one argument: the port obtained by opening
the named remote file for input.
</p>
<p>If the procedure returns, then the port is closed automatically and the values
yielded by the procedure are returned.  If the procedure does not return, then
the port will not be closed automatically unless it is possible to prove that
the port will never again be used for a read or write operation.
</p></dd></dl>

<dl>
<dt><a name="index-call_002dwith_002dremote_002doutput_002dfile"></a>Scheme Procedure: <strong>call-with-remote-output-file</strong><em> sftp-session filename proc</em></dt>
<dd><p>Call a <var>proc</var> with a remote file port opened for output using an
<var>sftp-session</var>.  <var>proc</var> should be a procedure of one argument,
<var>filename</var> should be a string naming a file.  The behaviour is unspecified
if a file already exists.
</p>
<p>The procedure calls <var>proc</var> with one argument: the port obtained by opening
the named remote file for output.
</p>
<p>If the procedure returns, then the port is closed automatically and the values
yielded by the procedure are returned.  If the procedure does not return, then
the port will not be closed automatically unless it is possible to prove that
the port will never again be used for a read or write operation.
</p></dd></dl>

<dl>
<dt><a name="index-with_002dinput_002dfrom_002dremote_002dfile"></a>Scheme Procedure: <strong>with-input-from-remote-file</strong><em> sftp-session filename thunk</em></dt>
<dd><p><var>thunk</var> must be a procedure of no arguments, and <var>filename</var> must be a
string naming a file.  The file must already exist. The file is opened for
input, an input port connected to it is made the default value returned by
<code>current-input-port</code>, and the <var>thunk</var> is called with no arguments.
When the <var>thunk</var> returns, the port is closed and the previous default is
restored.  Returns the values yielded by <var>thunk</var>.  If an escape procedure
is used to escape from the continuation of these procedures, their behavior is
implementation dependent.
</p>
<p>Example:
</p>
<div class="lisp">
<pre class="lisp">(define (rcat user host filename)
  &quot;Print contents of a remote file on a HOST pointed by a FILENAME to
stdout.&quot;
  (let ((session (make-session #:user user #:host host)))

    ;; Connect to an SSH server.
    (connect! session)

    (authenticate-server session)

    ;; Authenticate with an SSH server using a SSH agent.
    (userauth-agent! session)

    (let ((sftp-session (make-sftp-session session)))

      ;; Read read a file line-by-line and print it to stdout.
      (with-input-from-remote-file sftp-session filename
        (lambda ()
          (do ((line (read-line) (read-line)))
              ((eof-object? line))
            (write-line line)))))))
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-with_002doutput_002dto_002dremote_002dfile"></a>Scheme Procedure: <strong>with-output-to-remote-file</strong><em> sftp-session filename thunk</em></dt>
<dd><p><var>thunk</var> must be a procedure of no arguments, and <var>filename</var> must be a
string naming a file.  The effect is unspecified if the file already exists.
The file is opened for output, an output port connected to it is made the
default value returned by <code>current-output-port</code>, and the <var>thunk</var> is
called with no arguments.  When the <var>thunk</var> returns, the port is closed
and the previous default is restored.  Returns the values yielded by
<var>thunk</var>.  If an escape procedure is used to escape from the continuation
of these procedures, their behavior is implementation dependent.
</p></dd></dl>


<hr>
<a name="Distributed-Forms"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#High_002dlevel-operations-on-remote-files" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#API-Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-API" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Distributed-Forms-1"></a>
<h2 class="section">3.14 Distributed Forms</h2>

<a name="index-secure-distributed-computing"></a>

<p>The <code>(ssh dist)</code> module provides the spirit of distributed computing for
Guile.
</p>
<p>To make use of the procedures listed in this section you will need an SSH
daemon and a GNU Guile REPL server both running on the remote host.
</p>
<p>Also note that currently there may be cases in which distributed procedures
may fail to (de)serialise data; namely <code>make-vector</code> is one of such
procedures which output may be troublesome for <code>with-ssh</code>.  To overcome
this specific case one could pass the <code>fill</code> argument to
<code>make-vector</code> to fill the newly created vector with the specified filling
instead of <code>#&lt;unspecified&gt;</code>.
</p>
<p>Node management procedures:
</p>
<dl>
<dt><a name="index-make_002dnode"></a>Scheme Procedure: <strong>make-node</strong><em> session [repl-port=37146] [#:start-repl-server?=#t] [#:stop-repl-server?=#f]</em></dt>
<dd><p>Make a new node that uses an SSH <var>session</var> to connect to a <var>repl-port</var>
number on the remote side.  Return a new node.
</p>
<p>If <var>start-repl-server?</var> is set to <code>#t</code> (which is by default) then
start a REPL server on a remote host automatically in case when it is not
started yet.
</p>
<p>If <var>stop-repl-server?</var> is set to #t then a REPL server will be stopped as
soon as an evaluation is done.  Alternatively you could use
<code>node-stop-server</code> procedure from <code>(ssh dist node)</code> to stop the
server when it is not needed anymore.
</p>
<p>Note that when either <var>start-repl-server?</var> or <var>stop-repl-server?</var> are
specified, Guile-SSH tries to use <code>pgrep</code>/<code>pkill</code> from
<a href="https://gitlab.com/procps-ng/procps">procps</a> package first to start/stop
a remote Guile process, but if the package is missing then the Guile-SSH falls
back to its own implementation of the commands (for more details see
see section <a href="#Shell">Guile-SSH shell API</a>)
</p>
</dd></dl>

<dl>
<dt><a name="index-node_003f"></a>Scheme Procedure: <strong>node?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a node object, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-node_002dsession"></a>Scheme Procedure: <strong>node-session</strong><em> node</em></dt>
<dd><p>Get underlying SSH session from <var>node</var>.
</p></dd></dl>

<dl>
<dt><a name="index-node_002drepl_002dport"></a>Scheme Procedure: <strong>node-repl-port</strong><em> node</em></dt>
<dd><p>Get REPL port number from a <var>node</var>.
</p></dd></dl>

<dl>
<dt><a name="index-node_002dloadavg"></a>Scheme Procedure: <strong>node-loadavg</strong><em> node</em></dt>
<dd><p>Get average load of a <var>node</var>.  Return multiple values.  The 1st value is
an alist of five elements as described in proc(5) man page.  The rest of
values are as described in documentation for <code>node-eval</code> procedure.
</p>
<p>For example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh auth)
             (ssh session)
             (ssh dist node))

(let ((s (make-session #:host &quot;example.org&quot;)))
  (connect! s)
  (userauth-agent! s)
  (let ((n (make-node s)))
    (node-loadavg n)))
&rArr; ((one . 0.15) (five . 0.14) (fifteen . 0.16) (scheduling-entities 1 189) (last-pid . 15629))
&rArr; 1
&rArr; &quot;(guile-user)&quot;
&rArr; &quot;scheme&quot;
</pre></div>

</dd></dl>

<p>Interaction with remote REPLs:
</p>
<dl>
<dt><a name="index-distribute"></a>Scheme Procedure: <strong>distribute</strong><em> nodes expr ...</em></dt>
<dd><p>Evaluate each <var>expr</var> in parallel, using distributed computation.  Split
the job to nearly equal parts and hand out each of resulting sub-jobs to
<var>nodes</var> list.  Return the results of N expressions as a set of N multiple
values (see <a href="guile.html#Multiple-Values">Multiple Values</a> in <cite>The GNU Guile Reference Manual</cite>).
</p></dd></dl>

<dl>
<dt><a name="index-dist_002dmap"></a>Scheme Procedure: <strong>dist-map</strong><em> nodes proc lst</em></dt>
<dd><p>Do list mapping using distributed computation.  Split the work into nearly
equal parts and hand out the resulting jobs to <var>nodes</var> list.  Return the
result of computation.
</p>
<p>If for some reason a job could not be executed on a node (for example, if
connection to a remote REPL fails), <code>dist-map</code> transfers the job to
another node from the <var>nodes</var> list.  When job execution failed on all
nodes, an error is reported.
</p>
<p>In a case when an error that occurred during job execution is considered
non-recoverable (eg. when evaluation of <var>proc</var> on a node failed due to an
unbound variable) then execution of a job stops immediately.
</p></dd></dl>

<dl>
<dt><a name="index-with_002dssh"></a>Scheme Procedure: <strong>with-ssh</strong><em> node exp ...</em></dt>
<dd><p>Evaluate expressions on a remote REPL using a <var>node</var>, return four values:
an evaluation result, a number of the evaluation, a module name and a language
name.  Throw <code>node-error</code> or <code>node-repl-error</code> on an error.
</p>
<p>Example:
</p><div class="lisp">
<pre class="lisp">(use-modules (ssh session)
             (ssh auth)
             (ssh dist))

(let ((session (make-session #:user &quot;alice&quot; #:host &quot;www.example.org&quot;)))
  (connect! session)
  (userauth-agent! session)
  (display (with-ssh (make-node session)
             (gethostname)))
  (newline))
</pre></div>

<p>If an expression is evaluated to multiple values then the 1st value returned
by <code>with-ssh</code> will be a vector of the evaluated values and the 2nd value
will be a vector of evaluation numbers.  In this case the 2nd value can be
used to check whether <code>with-ssh</code> body evaluated to multiple values or
not.  For example:
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh session)
             (ssh auth)
             (ssh dist))

(let ((session (make-session #:user &quot;alice&quot; #:host &quot;www.example.org&quot;)))
  (connect! session)
  (userauth-agent! session)
  (with-ssh (make-node session)
    (values 1 2)))
=&gt; #(1 2)
=&gt; #(39 40)
=&gt; &quot;(guile-user)&quot;
=&gt; &quot;scheme&quot;
</pre></div>

</dd></dl>

<dl>
<dt><a name="index-rrepl"></a>Scheme Procedure: <strong>rrepl</strong><em> node</em></dt>
<dd><p>Start an interactive remote REPL (RREPL) session using <var>node</var>.
</p></dd></dl>

<hr>
<a name="Low_002dlevel-API"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Distributed-Forms" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Distributed-Forms" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Nodes" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h3 class="subsection">3.14.1 Low-level API</h3>

<hr>
<a name="Nodes"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-API" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-API" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Jobs" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.14.1.1 Nodes</h4>
<a name="index-node"></a>

<p>The module <code>(ssh dist node)</code> provides low-level API for node management.
Here&rsquo;s the description of the format of node type printed representation:
</p>
<div class="example">
<pre class="example">#&lt;node avp@127.0.0.1:22/37146 a0dbdc0&gt;
       A   A         A  A     A
       |   |         |  |     |
   ,---'   |       ,-'  '---. '-----------.
   |       |       |        |             |
 user     host   port   REPL port    object address
</pre></div>

<p>There are two types of node errors: recoverable and non-recoverable.  The
first group is represented by <code>node-error</code> exceptions.  If an exception
of this kind is occurred then there is a chance that a job can be executed on
another node.  That&rsquo;s because such an exception occures in cases when a node
is unreachable, for example.  The second group is represented by
<code>node-repl-error</code> exceptions.  Such exceptions mean that an error is
occurred during execution of a job on a node&rsquo;s REPL &ndash; eg. due to the malformed
job.  Those errors are non-recoverable because if the job is broken it will
likely fail on another nodes as well.
</p>
<p>In addition to <code>make-node</code>, <code>node?</code>, <code>node-session</code> and
<code>node-repl-port</code> the module provides:
</p>
<dl>
<dt><a name="index-node_002deval"></a>Scheme Procedure: <strong>node-eval</strong><em> node quoted-exp</em></dt>
<dd><p>Evaluate a <var>quoted-exp</var> on a <var>node</var> and return four values: an
evaluation result, a number of the evaluation, a module name and a language
name.  Throw <code>node-repl-error</code> if a non-recoverable error occurred, or
<code>node-error</code> if the evaluation potentially could be succesfully evaluated
on another node.
</p>
<p><strong>Note</strong> that <a href="https://gitlab.com/procps-ng/procps">procps</a> version
3.3.12 or later is needed on the server side in case of either
<code>start-repl-server?</code> or <code>stop-repl-server?</code> was set to <code>#t</code> for
a <var>NODE</var> (see the documentation for <code>make-node</code>.)
</p>
</dd></dl>

<dl>
<dt><a name="index-node_002dopen_002drrepl"></a>Scheme Procedure: <strong>node-open-rrepl</strong><em> node</em></dt>
<dd><p>Open a remote REPL (RREPL).  Return a new RREPL channel.
</p></dd></dl>

<dl>
<dt><a name="index-node_002drun_002dserver"></a>Scheme Procedure: <strong>node-run-server</strong><em> node</em></dt>
<dd><p>Run a REPL server on a <var>node</var>. Throw <code>node-error</code> with the current
node and the Guile return code from a server on an error.
</p></dd></dl>

<dl>
<dt><a name="index-node_002dstop_002dserver"></a>Scheme Procedure: <strong>node-stop-server</strong><em> node</em></dt>
<dd><p>Stop a RREPL server on a <var>node</var>.
</p></dd></dl>

<dl>
<dt><a name="index-node_002dguile_002dversion"></a>Scheme Procedure: <strong>node-guile-version</strong><em> node</em></dt>
<dd><p>Get Guile version installed on a <var>node</var>, return the version string.
Return <code>#f</code> if Guile is not installed.
</p></dd></dl>

<dl>
<dt><a name="index-node_002dserver_002drunning_003f"></a>Scheme Procedure: <strong>node-server-running?</strong><em> node</em></dt>
<dd><p>Check if a REPL server is running on a <var>node</var>, return <code>#t</code> if it is
running and listens on an expected port, return <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-rrepl_002deval"></a>Scheme Procedure: <strong>rrepl-eval</strong><em> rrepl-channel expr</em></dt>
<dd><p>Evaluate expression <var>expr</var> using <var>rrepl-channel</var>, return four values:
an evaluation result, a number of the evaluation, a module name and a language
name.  Throw <code>node-repl-error</code> on an error.
</p></dd></dl>

<dl>
<dt><a name="index-rrepl_002dskip_002dto_002dprompt"></a>Scheme Procedure: <strong>rrepl-skip-to-prompt</strong><em> rrepl-channel</em></dt>
<dd><p>Read from <var>rrepl-channel</var> until REPL is observed.  Throw <code>node-error</code>
on an error.
</p></dd></dl>

<hr>
<a name="Jobs"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Nodes" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Low_002dlevel-API" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h4 class="subsubsection">3.14.1.2 Jobs</h4>
<a name="index-job"></a>

<p>The module <code>(ssh dist job)</code> provides low-level API for job management.
</p>
<p>Here&rsquo;s the description of the format of node type printed representation:
</p>
<div class="example">
<pre class="example">#&lt;job map #&lt;node avp@127.0.0.1:22/37147 a0dbdc0&gt; a1345a0&gt;
      A   A                                      A
      |   |                                      |
      |   '----------.                           |
      |              |                           |
   job type   node (see above)           job object address
</pre></div>

<dl>
<dt><a name="index-split"></a>Scheme Procedure: <strong>split</strong><em> lst count</em></dt>
<dd><p>Split a list <var>lst</var> into <var>count</var> chunks.  Return a list of chunks.
</p>
<p>Example:
</p><div class="lisp">
<pre class="lisp">(split '(a b c d) 2)
&rArr; '((a b) (c d))
</pre></div>
</dd></dl>

<dl>
<dt><a name="index-make_002djob"></a>Scheme Procedure: <strong>make-job</strong><em> type node data proc</em></dt>
<dd><p>Make a new job of <var>type</var> using <var>node</var>.
</p></dd></dl>

<dl>
<dt><a name="index-job_003f"></a>Scheme Procedure: <strong>job?</strong><em> x</em></dt>
<dd><p>Return <code>#t</code> if <var>x</var> is a job object, <code>#f</code> otherwise.
</p></dd></dl>

<dl>
<dt><a name="index-job_002dtype"></a>Scheme Procedure: <strong>job-type</strong><em> job</em></dt>
<dd><p>Get type of a <var>job</var>.
</p></dd></dl>

<dl>
<dt><a name="index-job_002dnode"></a>Scheme Procedure: <strong>job-node</strong><em> job</em></dt>
<dd><p>Get a <var>job</var> node.
</p></dd></dl>

<dl>
<dt><a name="index-set_002djob_002dnode"></a>Scheme Procedure: <strong>set-job-node</strong><em> job node</em></dt>
<dd><p>Transfer <var>job</var> to a new <var>node</var>.  Return a new job object.
</p></dd></dl>

<dl>
<dt><a name="index-job_002ddata"></a>Scheme Procedure: <strong>job-data</strong><em> job</em></dt>
<dd><p>Get a <var>job</var> data.
</p></dd></dl>

<dl>
<dt><a name="index-job_002dproc"></a>Scheme Procedure: <strong>job-proc</strong><em> job</em></dt>
<dd><p>Get a <var>job</var> procedure.
</p></dd></dl>

<dl>
<dt><a name="index-assign_002deval"></a>Scheme Procedure: <strong>assign-eval</strong><em> nodes expressions</em></dt>
<dd><p>Split an <var>expressions</var> list to nearly equal parts according to the length
of a <var>nodes</var> list and assign each evaluation job to a node.  Return a list
of assigned jobs.
</p></dd></dl>

<dl>
<dt><a name="index-assign_002dmap"></a>Scheme Procedure: <strong>assign-map</strong><em> nodes lst proc</em></dt>
<dd><p>Split the work to nearly equal parts according to length of <var>nodes</var> list
and assign each part of work to a node.  Return list of assigned jobs.
</p></dd></dl>

<dl>
<dt><a name="index-hand_002dout_002djob"></a>Scheme Procedure: <strong>hand-out-job</strong><em> job</em></dt>
<dd><p>Hand out <var>job</var> to the assigned node and return the result of computation.
</p></dd></dl>

<dl>
<dt><a name="index-job_002d_003esexp"></a>Scheme Procedure: <strong>job-&gt;sexp</strong><em> job</em></dt>
<dd><p>Convert a <var>job</var> to an equivalent symbolic expression.
</p></dd></dl>



<hr>
<a name="Examples"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#API-Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Jobs" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Client" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgments" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Examples-1"></a>
<h1 class="chapter">4 Examples</h1>

<p>There are working examples that come with Guile-SSH.  These examples are
normally installed in &lsquo;<tt>$prefix/share/guile-ssh/examples</tt>&rsquo; directory:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>sssh.scm</samp>&rsquo;</dt>
<dt>&lsquo;<samp>ssshd.scm</samp>&rsquo;</dt>
<dd><p>Guile-SSH client and server example.
</p></dd>
<dt>&lsquo;<samp>echo/client.scm</samp>&rsquo;</dt>
<dt>&lsquo;<samp>echo/server.scm</samp>&rsquo;</dt>
<dd><p>Echo client and server example.
</p></dd>
</dl>

<p>In addition, the following sections will provide an overview of programming
with Guile-SSH.
</p>
<hr>
<a name="Client"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Examples" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Server" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgments" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">4.1 Client</h2>

<p>In this example we will connect to a server, open a channel and execute a
command.  Then we will read output from the command and close connection to
the server.
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh channel)
             (ssh session)
             (ssh auth)
             (ssh key))

(let ((session (make-session #:user          &quot;bob&quot;
                             #:host          &quot;example.com&quot;
                             #:port          22
                             #:log-verbosity 'nolog))) ; Be quiet
  ;; Connect to the server
  (connect! session)

  ;; Perform server authentication
  (case (authenticate-server session)
    ...) ; Check the result

  ;; Try to authenticate on the server with one of the `userauth-*'
  ;; procedures.  Let's use `userauth-agent!'.
  (case (userauth-agent! session)
    ...) ; Check the result

  ;; Suppose the authentication went successfully.
  ;; Now we need to open a channel.
  (let ((channel (make-channel session)))

    (if (not channel)
        ...) ; Handle an error

    ;; Open a session so we will be able to execute a command
    ;; on the server
    (catch 'guile-ssh-error
      (lambda () (channel-open-session channel))
      (lambda (key . args)
        ...)) ; Handle an error

    ;; Execute a command
    (channel-request-exec channel &quot;uname&quot;)

    ;; Check the exit status of the command
    (or (zero? (channel-get-exit-status channel))
        ...) ; Handle error

    ;; Poll the channel for data
    (let poll ((ready? #f))
      (if ready?
        (begin
          ...) ; Read the output from the command
        (poll (char-ready? channel))))

    ;; Close the channel
    (close channel)

    ;; Disconnect from the server
    (disconnect! session)))
</pre></div>

<hr>
<a name="Server"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Examples" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Client" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Examples" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgments" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgments" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h2 class="section">4.2 Server</h2>

<p>In this example we will create a new server and start the server loop.
</p>
<div class="lisp">
<pre class="lisp">(use-modules (ssh server)
             (ssh message)
             (ssh session)
             (ssh channel)
             (ssh key)
             (ssh auth))

(let ((server (make-server #:bindport      22
                           #:rsakey        &quot;/home/alice/.ssh/host_rsa_key&quot;
                           #:dsakey        &quot;/home/alice/.ssh/host_dsa_key&quot;
                           #:log-verbosity 'nolog))) ; Be quiet

  ;; Start listen to incoming connections.
  (server-listen server)

  ;; Start the main loop of the server
  (while #t

    ;; Accept new connections from clients.  Every connection is
    ;; handled in its own SSH session.
    (let ((session (catch 'guile-ssh-error
                     (lambda () (server-accept server))
                     (lambda (key . args)
                       ;; Handle an error
                       #f))))

      (if (not session)
        (begin
          (sleep 1)
          (continue)))

      ;; Handle server authentication request from a client
      (server-handle-key-exchange session)

      ;; Start the session loop.  Handle incoming messages from
      ;; the client
      (let session-loop ((msg (server-message-get session)))

        (if (not msg)
          ...) ; Handle an error

        ;; Get type of the received message
        (let ((msg-type (message-get-type msg)))

          ;; Handle the message according to the type.  Type is a list of
          ;; symbols where the car is the type and cadr is subtype.
          (case (car msg-type)

            ((request-service)
              ...) ; Handle service request

            ((request-auth)
              ...) ; Handle authentication request

            ((request-channel-open)
              ...) ; Handle request

            ((request-channel)
              ...))) ; Handle request

        (if (connected? session)
            (session-loop (server-message-get session))))

      (disconnect! session))))
</pre></div>


<hr>
<a name="Acknowledgments"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Examples" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Server" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#GNU-Free-Documentation-License" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#GNU-Free-Documentation-License" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Acknowledgments-1"></a>
<h1 class="chapter">5 Acknowledgments</h1>

<p>The <a href="http://www.libssh.org/">libssh</a> that is used by Guile-SSH is
initially written by Aris Adamantiadis and being developed by the developer
community.  See &lsquo;<tt>AUTHORS</tt>&rsquo; file that comes along with libssh distribution
for full authors list.
</p>
<p>Also I&rsquo;d like to thank all the people who contributed their precious time and
skills to send bug reports and patches for Guile-SSH.  Please see &lsquo;<tt>THANKS</tt>&rsquo;
file in the Guile-SSH repository for the full list of contributors.
</p>
<p>Thank you.
</p>
<p>- Artyom &ldquo;avp&rdquo; Poptsov
</p>
<hr>
<a name="GNU-Free-Documentation-License"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Acknowledgments" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Acknowledgments" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="GNU-Free-Documentation-License-1"></a>
<h1 class="appendix">Appendix A GNU Free Documentation License</h1>

<p align="center">Version 1.3, 3 November 2008
</p>

<div class="display">
<pre class="display">Copyright &copy; 2000, 2001, 2002, 2007, 2008 Free Software Foundation, Inc.
<a href="http://fsf.org/">http://fsf.org/</a>

Everyone is permitted to copy and distribute verbatim copies
of this license document, but changing it is not allowed.
</pre></div>

<ol>
<li>
PREAMBLE

<p>The purpose of this License is to make a manual, textbook, or other
functional and useful document <em>free</em> in the sense of freedom: to
assure everyone the effective freedom to copy and redistribute it,
with or without modifying it, either commercially or noncommercially.
Secondarily, this License preserves for the author and publisher a way
to get credit for their work, while not being considered responsible
for modifications made by others.
</p>
<p>This License is a kind of &ldquo;copyleft&rdquo;, which means that derivative
works of the document must themselves be free in the same sense.  It
complements the GNU General Public License, which is a copyleft
license designed for free software.
</p>
<p>We have designed this License in order to use it for manuals for free
software, because free software needs free documentation: a free
program should come with manuals providing the same freedoms that the
software does.  But this License is not limited to software manuals;
it can be used for any textual work, regardless of subject matter or
whether it is published as a printed book.  We recommend this License
principally for works whose purpose is instruction or reference.
</p>
</li><li>
APPLICABILITY AND DEFINITIONS

<p>This License applies to any manual or other work, in any medium, that
contains a notice placed by the copyright holder saying it can be
distributed under the terms of this License.  Such a notice grants a
world-wide, royalty-free license, unlimited in duration, to use that
work under the conditions stated herein.  The &ldquo;Document&rdquo;, below,
refers to any such manual or work.  Any member of the public is a
licensee, and is addressed as &ldquo;you&rdquo;.  You accept the license if you
copy, modify or distribute the work in a way requiring permission
under copyright law.
</p>
<p>A &ldquo;Modified Version&rdquo; of the Document means any work containing the
Document or a portion of it, either copied verbatim, or with
modifications and/or translated into another language.
</p>
<p>A &ldquo;Secondary Section&rdquo; is a named appendix or a front-matter section
of the Document that deals exclusively with the relationship of the
publishers or authors of the Document to the Document&rsquo;s overall
subject (or to related matters) and contains nothing that could fall
directly within that overall subject.  (Thus, if the Document is in
part a textbook of mathematics, a Secondary Section may not explain
any mathematics.)  The relationship could be a matter of historical
connection with the subject or with related matters, or of legal,
commercial, philosophical, ethical or political position regarding
them.
</p>
<p>The &ldquo;Invariant Sections&rdquo; are certain Secondary Sections whose titles
are designated, as being those of Invariant Sections, in the notice
that says that the Document is released under this License.  If a
section does not fit the above definition of Secondary then it is not
allowed to be designated as Invariant.  The Document may contain zero
Invariant Sections.  If the Document does not identify any Invariant
Sections then there are none.
</p>
<p>The &ldquo;Cover Texts&rdquo; are certain short passages of text that are listed,
as Front-Cover Texts or Back-Cover Texts, in the notice that says that
the Document is released under this License.  A Front-Cover Text may
be at most 5 words, and a Back-Cover Text may be at most 25 words.
</p>
<p>A &ldquo;Transparent&rdquo; copy of the Document means a machine-readable copy,
represented in a format whose specification is available to the
general public, that is suitable for revising the document
straightforwardly with generic text editors or (for images composed of
pixels) generic paint programs or (for drawings) some widely available
drawing editor, and that is suitable for input to text formatters or
for automatic translation to a variety of formats suitable for input
to text formatters.  A copy made in an otherwise Transparent file
format whose markup, or absence of markup, has been arranged to thwart
or discourage subsequent modification by readers is not Transparent.
An image format is not Transparent if used for any substantial amount
of text.  A copy that is not &ldquo;Transparent&rdquo; is called &ldquo;Opaque&rdquo;.
</p>
<p>Examples of suitable formats for Transparent copies include plain
<small>ASCII</small> without markup, Texinfo input format, LaTeX input
format, <acronym>SGML</acronym> or <acronym>XML</acronym> using a publicly available
<acronym>DTD</acronym>, and standard-conforming simple <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> designed for human modification.  Examples
of transparent image formats include <acronym>PNG</acronym>, <acronym>XCF</acronym> and
<acronym>JPG</acronym>.  Opaque formats include proprietary formats that can be
read and edited only by proprietary word processors, <acronym>SGML</acronym> or
<acronym>XML</acronym> for which the <acronym>DTD</acronym> and/or processing tools are
not generally available, and the machine-generated <acronym>HTML</acronym>,
PostScript or <acronym>PDF</acronym> produced by some word processors for
output purposes only.
</p>
<p>The &ldquo;Title Page&rdquo; means, for a printed book, the title page itself,
plus such following pages as are needed to hold, legibly, the material
this License requires to appear in the title page.  For works in
formats which do not have any title page as such, &ldquo;Title Page&rdquo; means
the text near the most prominent appearance of the work&rsquo;s title,
preceding the beginning of the body of the text.
</p>
<p>The &ldquo;publisher&rdquo; means any person or entity that distributes copies
of the Document to the public.
</p>
<p>A section &ldquo;Entitled XYZ&rdquo; means a named subunit of the Document whose
title either is precisely XYZ or contains XYZ in parentheses following
text that translates XYZ in another language.  (Here XYZ stands for a
specific section name mentioned below, such as &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, &ldquo;Endorsements&rdquo;, or &ldquo;History&rdquo;.)  To &ldquo;Preserve the Title&rdquo;
of such a section when you modify the Document means that it remains a
section &ldquo;Entitled XYZ&rdquo; according to this definition.
</p>
<p>The Document may include Warranty Disclaimers next to the notice which
states that this License applies to the Document.  These Warranty
Disclaimers are considered to be included by reference in this
License, but only as regards disclaiming warranties: any other
implication that these Warranty Disclaimers may have is void and has
no effect on the meaning of this License.
</p>
</li><li>
VERBATIM COPYING

<p>You may copy and distribute the Document in any medium, either
commercially or noncommercially, provided that this License, the
copyright notices, and the license notice saying this License applies
to the Document are reproduced in all copies, and that you add no other
conditions whatsoever to those of this License.  You may not use
technical measures to obstruct or control the reading or further
copying of the copies you make or distribute.  However, you may accept
compensation in exchange for copies.  If you distribute a large enough
number of copies you must also follow the conditions in section 3.
</p>
<p>You may also lend copies, under the same conditions stated above, and
you may publicly display copies.
</p>
</li><li>
COPYING IN QUANTITY

<p>If you publish printed copies (or copies in media that commonly have
printed covers) of the Document, numbering more than 100, and the
Document&rsquo;s license notice requires Cover Texts, you must enclose the
copies in covers that carry, clearly and legibly, all these Cover
Texts: Front-Cover Texts on the front cover, and Back-Cover Texts on
the back cover.  Both covers must also clearly and legibly identify
you as the publisher of these copies.  The front cover must present
the full title with all words of the title equally prominent and
visible.  You may add other material on the covers in addition.
Copying with changes limited to the covers, as long as they preserve
the title of the Document and satisfy these conditions, can be treated
as verbatim copying in other respects.
</p>
<p>If the required texts for either cover are too voluminous to fit
legibly, you should put the first ones listed (as many as fit
reasonably) on the actual cover, and continue the rest onto adjacent
pages.
</p>
<p>If you publish or distribute Opaque copies of the Document numbering
more than 100, you must either include a machine-readable Transparent
copy along with each Opaque copy, or state in or with each Opaque copy
a computer-network location from which the general network-using
public has access to download using public-standard network protocols
a complete Transparent copy of the Document, free of added material.
If you use the latter option, you must take reasonably prudent steps,
when you begin distribution of Opaque copies in quantity, to ensure
that this Transparent copy will remain thus accessible at the stated
location until at least one year after the last time you distribute an
Opaque copy (directly or through your agents or retailers) of that
edition to the public.
</p>
<p>It is requested, but not required, that you contact the authors of the
Document well before redistributing any large number of copies, to give
them a chance to provide you with an updated version of the Document.
</p>
</li><li>
MODIFICATIONS

<p>You may copy and distribute a Modified Version of the Document under
the conditions of sections 2 and 3 above, provided that you release
the Modified Version under precisely this License, with the Modified
Version filling the role of the Document, thus licensing distribution
and modification of the Modified Version to whoever possesses a copy
of it.  In addition, you must do these things in the Modified Version:
</p>
<ol>
<li>
Use in the Title Page (and on the covers, if any) a title distinct
from that of the Document, and from those of previous versions
(which should, if there were any, be listed in the History section
of the Document).  You may use the same title as a previous version
if the original publisher of that version gives permission.

</li><li>
List on the Title Page, as authors, one or more persons or entities
responsible for authorship of the modifications in the Modified
Version, together with at least five of the principal authors of the
Document (all of its principal authors, if it has fewer than five),
unless they release you from this requirement.

</li><li>
State on the Title page the name of the publisher of the
Modified Version, as the publisher.

</li><li>
Preserve all the copyright notices of the Document.

</li><li>
Add an appropriate copyright notice for your modifications
adjacent to the other copyright notices.

</li><li>
Include, immediately after the copyright notices, a license notice
giving the public permission to use the Modified Version under the
terms of this License, in the form shown in the Addendum below.

</li><li>
Preserve in that license notice the full lists of Invariant Sections
and required Cover Texts given in the Document&rsquo;s license notice.

</li><li>
Include an unaltered copy of this License.

</li><li>
Preserve the section Entitled &ldquo;History&rdquo;, Preserve its Title, and add
to it an item stating at least the title, year, new authors, and
publisher of the Modified Version as given on the Title Page.  If
there is no section Entitled &ldquo;History&rdquo; in the Document, create one
stating the title, year, authors, and publisher of the Document as
given on its Title Page, then add an item describing the Modified
Version as stated in the previous sentence.

</li><li>
Preserve the network location, if any, given in the Document for
public access to a Transparent copy of the Document, and likewise
the network locations given in the Document for previous versions
it was based on.  These may be placed in the &ldquo;History&rdquo; section.
You may omit a network location for a work that was published at
least four years before the Document itself, or if the original
publisher of the version it refers to gives permission.

</li><li>
For any section Entitled &ldquo;Acknowledgements&rdquo; or &ldquo;Dedications&rdquo;, Preserve
the Title of the section, and preserve in the section all the
substance and tone of each of the contributor acknowledgements and/or
dedications given therein.

</li><li>
Preserve all the Invariant Sections of the Document,
unaltered in their text and in their titles.  Section numbers
or the equivalent are not considered part of the section titles.

</li><li>
Delete any section Entitled &ldquo;Endorsements&rdquo;.  Such a section
may not be included in the Modified Version.

</li><li>
Do not retitle any existing section to be Entitled &ldquo;Endorsements&rdquo; or
to conflict in title with any Invariant Section.

</li><li>
Preserve any Warranty Disclaimers.
</li></ol>

<p>If the Modified Version includes new front-matter sections or
appendices that qualify as Secondary Sections and contain no material
copied from the Document, you may at your option designate some or all
of these sections as invariant.  To do this, add their titles to the
list of Invariant Sections in the Modified Version&rsquo;s license notice.
These titles must be distinct from any other section titles.
</p>
<p>You may add a section Entitled &ldquo;Endorsements&rdquo;, provided it contains
nothing but endorsements of your Modified Version by various
parties&mdash;for example, statements of peer review or that the text has
been approved by an organization as the authoritative definition of a
standard.
</p>
<p>You may add a passage of up to five words as a Front-Cover Text, and a
passage of up to 25 words as a Back-Cover Text, to the end of the list
of Cover Texts in the Modified Version.  Only one passage of
Front-Cover Text and one of Back-Cover Text may be added by (or
through arrangements made by) any one entity.  If the Document already
includes a cover text for the same cover, previously added by you or
by arrangement made by the same entity you are acting on behalf of,
you may not add another; but you may replace the old one, on explicit
permission from the previous publisher that added the old one.
</p>
<p>The author(s) and publisher(s) of the Document do not by this License
give permission to use their names for publicity for or to assert or
imply endorsement of any Modified Version.
</p>
</li><li>
COMBINING DOCUMENTS

<p>You may combine the Document with other documents released under this
License, under the terms defined in section 4 above for modified
versions, provided that you include in the combination all of the
Invariant Sections of all of the original documents, unmodified, and
list them all as Invariant Sections of your combined work in its
license notice, and that you preserve all their Warranty Disclaimers.
</p>
<p>The combined work need only contain one copy of this License, and
multiple identical Invariant Sections may be replaced with a single
copy.  If there are multiple Invariant Sections with the same name but
different contents, make the title of each such section unique by
adding at the end of it, in parentheses, the name of the original
author or publisher of that section if known, or else a unique number.
Make the same adjustment to the section titles in the list of
Invariant Sections in the license notice of the combined work.
</p>
<p>In the combination, you must combine any sections Entitled &ldquo;History&rdquo;
in the various original documents, forming one section Entitled
&ldquo;History&rdquo;; likewise combine any sections Entitled &ldquo;Acknowledgements&rdquo;,
and any sections Entitled &ldquo;Dedications&rdquo;.  You must delete all
sections Entitled &ldquo;Endorsements.&rdquo;
</p>
</li><li>
COLLECTIONS OF DOCUMENTS

<p>You may make a collection consisting of the Document and other documents
released under this License, and replace the individual copies of this
License in the various documents with a single copy that is included in
the collection, provided that you follow the rules of this License for
verbatim copying of each of the documents in all other respects.
</p>
<p>You may extract a single document from such a collection, and distribute
it individually under this License, provided you insert a copy of this
License into the extracted document, and follow this License in all
other respects regarding verbatim copying of that document.
</p>
</li><li>
AGGREGATION WITH INDEPENDENT WORKS

<p>A compilation of the Document or its derivatives with other separate
and independent documents or works, in or on a volume of a storage or
distribution medium, is called an &ldquo;aggregate&rdquo; if the copyright
resulting from the compilation is not used to limit the legal rights
of the compilation&rsquo;s users beyond what the individual works permit.
When the Document is included in an aggregate, this License does not
apply to the other works in the aggregate which are not themselves
derivative works of the Document.
</p>
<p>If the Cover Text requirement of section 3 is applicable to these
copies of the Document, then if the Document is less than one half of
the entire aggregate, the Document&rsquo;s Cover Texts may be placed on
covers that bracket the Document within the aggregate, or the
electronic equivalent of covers if the Document is in electronic form.
Otherwise they must appear on printed covers that bracket the whole
aggregate.
</p>
</li><li>
TRANSLATION

<p>Translation is considered a kind of modification, so you may
distribute translations of the Document under the terms of section 4.
Replacing Invariant Sections with translations requires special
permission from their copyright holders, but you may include
translations of some or all Invariant Sections in addition to the
original versions of these Invariant Sections.  You may include a
translation of this License, and all the license notices in the
Document, and any Warranty Disclaimers, provided that you also include
the original English version of this License and the original versions
of those notices and disclaimers.  In case of a disagreement between
the translation and the original version of this License or a notice
or disclaimer, the original version will prevail.
</p>
<p>If a section in the Document is Entitled &ldquo;Acknowledgements&rdquo;,
&ldquo;Dedications&rdquo;, or &ldquo;History&rdquo;, the requirement (section 4) to Preserve
its Title (section 1) will typically require changing the actual
title.
</p>
</li><li>
TERMINATION

<p>You may not copy, modify, sublicense, or distribute the Document
except as expressly provided under this License.  Any attempt
otherwise to copy, modify, sublicense, or distribute it is void, and
will automatically terminate your rights under this License.
</p>
<p>However, if you cease all violation of this License, then your license
from a particular copyright holder is reinstated (a) provisionally,
unless and until the copyright holder explicitly and finally
terminates your license, and (b) permanently, if the copyright holder
fails to notify you of the violation by some reasonable means prior to
60 days after the cessation.
</p>
<p>Moreover, your license from a particular copyright holder is
reinstated permanently if the copyright holder notifies you of the
violation by some reasonable means, this is the first time you have
received notice of violation of this License (for any work) from that
copyright holder, and you cure the violation prior to 30 days after
your receipt of the notice.
</p>
<p>Termination of your rights under this section does not terminate the
licenses of parties who have received copies or rights from you under
this License.  If your rights have been terminated and not permanently
reinstated, receipt of a copy of some or all of the same material does
not give you any rights to use it.
</p>
</li><li>
FUTURE REVISIONS OF THIS LICENSE

<p>The Free Software Foundation may publish new, revised versions
of the GNU Free Documentation License from time to time.  Such new
versions will be similar in spirit to the present version, but may
differ in detail to address new problems or concerns.  See
<a href="http://www.gnu.org/copyleft/">http://www.gnu.org/copyleft/</a>.
</p>
<p>Each version of the License is given a distinguishing version number.
If the Document specifies that a particular numbered version of this
License &ldquo;or any later version&rdquo; applies to it, you have the option of
following the terms and conditions either of that specified version or
of any later version that has been published (not as a draft) by the
Free Software Foundation.  If the Document does not specify a version
number of this License, you may choose any version ever published (not
as a draft) by the Free Software Foundation.  If the Document
specifies that a proxy can decide which future versions of this
License can be used, that proxy&rsquo;s public statement of acceptance of a
version permanently authorizes you to choose that version for the
Document.
</p>
</li><li>
RELICENSING

<p>&ldquo;Massive Multiauthor Collaboration Site&rdquo; (or &ldquo;MMC Site&rdquo;) means any
World Wide Web server that publishes copyrightable works and also
provides prominent facilities for anybody to edit those works.  A
public wiki that anybody can edit is an example of such a server.  A
&ldquo;Massive Multiauthor Collaboration&rdquo; (or &ldquo;MMC&rdquo;) contained in the
site means any set of copyrightable works thus published on the MMC
site.
</p>
<p>&ldquo;CC-BY-SA&rdquo; means the Creative Commons Attribution-Share Alike 3.0
license published by Creative Commons Corporation, a not-for-profit
corporation with a principal place of business in San Francisco,
California, as well as future copyleft versions of that license
published by that same organization.
</p>
<p>&ldquo;Incorporate&rdquo; means to publish or republish a Document, in whole or
in part, as part of another Document.
</p>
<p>An MMC is &ldquo;eligible for relicensing&rdquo; if it is licensed under this
License, and if all works that were first published under this License
somewhere other than this MMC, and subsequently incorporated in whole
or in part into the MMC, (1) had no cover texts or invariant sections,
and (2) were thus incorporated prior to November 1, 2008.
</p>
<p>The operator of an MMC Site may republish an MMC contained in the site
under CC-BY-SA on the same site at any time before August 1, 2009,
provided the MMC is eligible for relicensing.
</p>
</li></ol>


<a name="ADDENDUM_003a-How-to-use-this-License-for-your-documents"></a>
<h2 class="heading">ADDENDUM: How to use this License for your documents</h2>

<p>To use this License in a document you have written, include a copy of
the License in the document and put the following copyright and
license notices just after the title page:
</p>
<div class="smallexample">
<pre class="smallexample">  Copyright (C)  <var>year</var>  <var>your name</var>.
  Permission is granted to copy, distribute and/or modify this document
  under the terms of the GNU Free Documentation License, Version 1.3
  or any later version published by the Free Software Foundation;
  with no Invariant Sections, no Front-Cover Texts, and no Back-Cover
  Texts.  A copy of the license is included in the section entitled ``GNU
  Free Documentation License''.
</pre></div>

<p>If you have Invariant Sections, Front-Cover Texts and Back-Cover Texts,
replace the &ldquo;with&hellip;Texts.&rdquo; line with this:
</p>
<div class="smallexample">
<pre class="smallexample">    with the Invariant Sections being <var>list their titles</var>, with
    the Front-Cover Texts being <var>list</var>, and with the Back-Cover Texts
    being <var>list</var>.
</pre></div>

<p>If you have Invariant Sections without Cover Texts, or some other
combination of the three, merge those two alternatives to suit the
situation.
</p>
<p>If your document contains nontrivial examples of program code, we
recommend releasing these examples in parallel under your choice of
free software license, such as the GNU General Public License,
to permit their use in free software.
</p>




<hr>
<a name="Type-Index"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#GNU-Free-Documentation-License" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#GNU-Free-Documentation-License" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Procedure-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Procedure-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Type-Index-1"></a>
<h1 class="unnumbered">Type Index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Type-Index-1_tp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-tp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel"><code>channel</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-fingerprint-1"><code>fingerprint</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fingerprint-3"><code>fingerprint</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-job"><code>job</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-key"><code>key</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-message"><code>message</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Messages">3.12 Messages</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-node"><code>node</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-request"><code>request</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Type-Index-1_tp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-server"><code>server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-session"><code>session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Type-Index-1_tp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Type-Index-1_tp_letter-S"><b>S</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="Procedure-Index"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Type-Index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Concept-Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Procedure-Index-1"></a>
<h1 class="unnumbered">Procedure Index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Procedure-Index-1_fn_symbol-1"><b>%</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-W"><b>W</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-fn" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_symbol-1">%</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025default_002dlibssh_002dlog_002dprinter"><code>%default-libssh-log-printer</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025default_002dlog_002dprinter"><code>%default-log-printer</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025get_002dlibssh_002dversion"><code>%get-libssh-version</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025make_002dserver"><code>%make-server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025make_002dsession"><code>%make-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025make_002dsftp_002dsession"><code>%make-sftp-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Low_002dLevel-API">3.13.1.1 Low-Level API</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-_0025sftp_002dinit"><code>%sftp-init</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Low_002dLevel-API">3.13.1.1 Low-Level API</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-assign_002deval"><code>assign-eval</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-assign_002dmap"><code>assign-map</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-auth_002dreq_003apassword"><code>auth-req:password</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-auth_002dreq_003apubkey"><code>auth-req:pubkey</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-auth_002dreq_003apubkey_002dstate"><code>auth-req:pubkey-state</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-auth_002dreq_003auser"><code>auth-req:user</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-authenticate_002dserver"><code>authenticate-server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-B">B</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-blocking_002dflush_0021"><code>blocking-flush!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-bytevector_002d_003ehex_002dstring"><code>bytevector-&gt;hex-string</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-call_002dwith_002dremote_002dinput_002dfile"><code>call-with-remote-input-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#High_002dlevel-operations-on-remote-files">3.13.3 High-level operations on remote files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-call_002dwith_002dremote_002doutput_002dfile"><code>call-with-remote-output-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#High_002dlevel-operations-on-remote-files">3.13.3 High-level operations on remote files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-call_002dwith_002dssh_002dforward"><code>call-with-ssh-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002daccept_002dforward"><code>channel-accept-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dcancel_002dforward"><code>channel-cancel-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002deof_003f"><code>channel-eof?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dget_002dexit_002dstatus"><code>channel-get-exit-status</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dget_002dsession"><code>channel-get-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dget_002dstream"><code>channel-get-stream</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dlisten_002dforward"><code>channel-listen-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dforward"><code>channel-open-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dreq_003adest"><code>channel-open-req:dest</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dreq_003adest_002dport"><code>channel-open-req:dest-port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dreq_003aorig"><code>channel-open-req:orig</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dreq_003aorig_002dport"><code>channel-open-req:orig-port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_002dsession"><code>channel-open-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dopen_003f"><code>channel-open?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002drequest_002denv"><code>channel-request-env</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002drequest_002dexec"><code>channel-request-exec</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002drequest_002dpty"><code>channel-request-pty</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002drequest_002dsend_002dexit_002dstatus"><code>channel-request-send-exit-status</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002drequest_002dshell"><code>channel-request-shell</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dsend_002deof"><code>channel-send-eof</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dset_002dpty_002dsize_0021"><code>channel-set-pty-size!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_002dset_002dstream_0021"><code>channel-set-stream!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-channel_003f"><code>channel?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-command_002davailable_003f"><code>command-available?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-connect_0021"><code>connect!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-connect_002dstatus_002dcallback"><code>connect-status-callback</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Callbacks">3.1.2 Callbacks</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-connected_003f"><code>connected?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-current_002dlogging_002dcallback"><code>current-logging-callback</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-disconnect_0021"><code>disconnect!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-dist_002dmap"><code>dist-map</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-distribute"><code>distribute</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-E">E</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-env_002dreq_003aname"><code>env-req:name</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-env_002dreq_003avalue"><code>env-req:value</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-exec_002dreq_003acmd"><code>exec-req:cmd</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-format_002dlog"><code>format-log</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-G">G</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dcrypto_002dlibrary"><code>get-crypto-library</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002derror"><code>get-error</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dkey_002dtype"><code>get-key-type</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dlibrary_002dversion"><code>get-library-version</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dlibssh_002dversion"><code>get-libssh-version</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dlog_002duserdata"><code>get-log-userdata</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dlog_002dverbosity"><code>get-log-verbosity</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dprotocol_002dversion"><code>get-protocol-version</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dpublic_002dkey_002dhash"><code>get-public-key-hash</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-get_002dserver_002dpublic_002dkey"><code>get-server-public-key</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-global_002dreq_003aaddr"><code>global-req:addr</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-global_002dreq_003aport"><code>global-req:port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-global_002drequest_002dcallback"><code>global-request-callback</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Callbacks">3.1.2 Callbacks</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-hand_002dout_002djob"><code>hand-out-job</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-J">J</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_002d_003esexp"><code>job-&gt;sexp</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_002ddata"><code>job-data</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_002dnode"><code>job-node</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_002dproc"><code>job-proc</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_002dtype"><code>job-type</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-job_003f"><code>job?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-K">K</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-key_003f"><code>key?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-loadavg"><code>loadavg</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-M">M</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dchannel"><code>make-channel</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002djob"><code>make-job</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dkeypair"><code>make-keypair</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dnode"><code>make-node</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dserver"><code>make-server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dsession"><code>make-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dsftp_002dsession"><code>make-sftp-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-make_002dtunnel"><code>make-tunnel</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dauth_002dreply_002dpublic_002dkey_002dok"><code>message-auth-reply-public-key-ok</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dauth_002dreply_002dsuccess"><code>message-auth-reply-success</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dauth_002dset_002dmethods_0021"><code>message-auth-set-methods!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dchannel_002drequest_002dopen_002dreply_002daccept"><code>message-channel-request-open-reply-accept</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dchannel_002drequest_002dreply_002dsuccess"><code>message-channel-request-reply-success</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dget_002dreq"><code>message-get-req</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dget_002dsession"><code>message-get-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dget_002dtype"><code>message-get-type</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dglobal_002drequest_002dreply_002dsuccess"><code>message-global-request-reply-success</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dreply_002ddefault"><code>message-reply-default</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dreply_002dsuccess"><code>message-reply-success</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_002dservice_002dreply_002dsuccess"><code>message-service-reply-success</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-message_003f"><code>message?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Message-Handling">3.12.1 Messages Handling</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002deval"><code>node-eval</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dguile_002dversion"><code>node-guile-version</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dloadavg"><code>node-loadavg</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dopen_002drrepl"><code>node-open-rrepl</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002drepl_002dport"><code>node-repl-port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002drun_002dserver"><code>node-run-server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dserver_002drunning_003f"><code>node-server-running?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dsession"><code>node-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_002dstop_002dserver"><code>node-stop-server</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-node_003f"><code>node?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-O">O</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002dinput_002dpipe"><code>open-remote-input-pipe</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002dinput_002dpipe_002a"><code>open-remote-input-pipe*</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002doutput_002dpipe"><code>open-remote-output-pipe</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002doutput_002dpipe_002a"><code>open-remote-output-pipe*</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002dpipe"><code>open-remote-pipe</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-open_002dremote_002dpipe_002a"><code>open-remote-pipe*</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-pgrep"><code>pgrep</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pkill"><code>pkill</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-private_002dkey_002d_003epublic_002dkey"><code>private-key-&gt;public-key</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-private_002dkey_002dfrom_002dfile"><code>private-key-from-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-private_002dkey_002dto_002dfile"><code>private-key-to-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-private_002dkey_003f"><code>private-key?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pty_002dreq_003aheight"><code>pty-req:height</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pty_002dreq_003apxheight"><code>pty-req:pxheight</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pty_002dreq_003apxwidth"><code>pty-req:pxwidth</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pty_002dreq_003aterm"><code>pty-req:term</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-pty_002dreq_003awidth"><code>pty-req:width</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-public_002dkey_002d_003estring"><code>public-key-&gt;string</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-public_002dkey_002dfrom_002dfile"><code>public-key-from-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-public_002dkey_003f"><code>public-key?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-rexec"><code>rexec</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rrepl"><code>rrepl</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rrepl_002deval"><code>rrepl-eval</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-rrepl_002dskip_002dto_002dprompt"><code>rrepl-skip-to-prompt</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Nodes">3.14.1.1 Nodes</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002daccept"><code>server-accept</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002dget"><code>server-get</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002dhandle_002dkey_002dexchange"><code>server-handle-key-exchange</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002dlisten"><code>server-listen</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002dmessage_002dget"><code>server-message-get</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_002dset_0021"><code>server-set!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-server_003f"><code>server?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-service_002dreq_003aservice"><code>service-req:service</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-session_002dget"><code>session-get</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-session_002dparse_002dconfig_0021"><code>session-parse-config!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-session_002dset_0021"><code>session-set!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-session_003f"><code>session?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-set_002djob_002dnode"><code>set-job-node</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-set_002dlog_002duserdata_0021"><code>set-log-userdata!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-set_002dlog_002dverbosity_0021"><code>set-log-verbosity!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-set_002dlogging_002dcallback_0021"><code>set-logging-callback!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dchmod"><code>sftp-chmod</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dfile_003f"><code>sftp-file?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-file">3.13.2 SFTP file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dget_002derror"><code>sftp-get-error</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dget_002dsession"><code>sftp-get-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dmkdir"><code>sftp-mkdir</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dmv"><code>sftp-mv</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dopen"><code>sftp-open</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-file">3.13.2 SFTP file</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dreadlink"><code>sftp-readlink</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002drmdir"><code>sftp-rmdir</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dsession_003f"><code>sftp-session?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dsymlink"><code>sftp-symlink</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sftp_002dunlink"><code>sftp-unlink</code></a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP-session">3.13.1 SFTP session</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-split"><code>split</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Jobs">3.14.1.2 Jobs</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ssh_002dagent_002dinfo"><code>ssh-agent-info</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Getting-information-about-SSH-agents">3.3.2 Getting information about SSH agents</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ssh_002dagent_002dsock_002dget"><code>ssh-agent-sock-get</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Managing-SSH-agent-environment-variables">3.3.3 Managing SSH agent environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ssh_002dagent_002dsock_002dset_0021"><code>ssh-agent-sock-set!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Managing-SSH-agent-environment-variables">3.3.3 Managing SSH agent environment variables</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ssh_002dagent_002dstart"><code>ssh-agent-start</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Starting_002fstopping-SSH-agents">3.3.1 Starting/stopping SSH agents</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-ssh_002dagent_002dstop"><code>ssh-agent-stop</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Starting_002fstopping-SSH-agents">3.3.1 Starting/stopping SSH agents</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-start_002dforward"><code>start-forward</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-string_002d_003epublic_002dkey"><code>string-&gt;public-key</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dbind_002daddress"><code>tunnel-bind-address</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dhost"><code>tunnel-host</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dhost_002dport"><code>tunnel-host-port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dport"><code>tunnel-port</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dreverse_003f"><code>tunnel-reverse?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_002dsession"><code>tunnel-session</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-tunnel_003f"><code>tunnel?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-U">U</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dagent_0021"><code>userauth-agent!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dget_002dlist"><code>userauth-get-list</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dgssapi_0021"><code>userauth-gssapi!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dnone_0021"><code>userauth-none!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dpassword_0021"><code>userauth-password!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dpublic_002dkey_0021"><code>userauth-public-key!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dpublic_002dkey_002fauto_0021"><code>userauth-public-key/auto!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-userauth_002dpublic_002dkey_002ftry"><code>userauth-public-key/try</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-W">W</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-which"><code>which</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-with_002dinput_002dfrom_002dremote_002dfile"><code>with-input-from-remote-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#High_002dlevel-operations-on-remote-files">3.13.3 High-level operations on remote files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-with_002doutput_002dto_002dremote_002dfile"><code>with-output-to-remote-file</code></a></td><td>&nbsp;</td><td valign="top"><a href="#High_002dlevel-operations-on-remote-files">3.13.3 High-level operations on remote files</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-with_002dssh"><code>with-ssh</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-write_002dknown_002dhost_0021"><code>write-known-host!</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Procedure-Index-1_fn_letter-Z">Z</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-zlib_002dsupport_003f"><code>zlib-support?</code></a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Procedure-Index-1_fn_symbol-1"><b>%</b></a>
 &nbsp; 
<br>
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-B"><b>B</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-E"><b>E</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-G"><b>G</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-J"><b>J</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-K"><b>K</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-M"><b>M</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-O"><b>O</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-U"><b>U</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-W"><b>W</b></a>
 &nbsp; 
<a class="summary-letter" href="#Procedure-Index-1_fn_letter-Z"><b>Z</b></a>
 &nbsp; 
</td></tr></table>

<hr>
<a name="Concept-Index"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Procedure-Index" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Procedure-Index" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Concept-Index-1"></a>
<h1 class="unnumbered">Concept Index</h1>

<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-Index-1_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-V"><b>V</b></a>
 &nbsp; 
</td></tr></table>
<table class="index-cp" border="0">
<tr><td></td><th align="left">Index Entry</th><td>&nbsp;</td><th align="left"> Section</th></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-A">A</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-agent">agent</a></td><td>&nbsp;</td><td valign="top"><a href="#Agent">3.3 Agent</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-authentication">authentication</a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-authentication-with-a-SSH-agent">authentication with a SSH agent</a></td><td>&nbsp;</td><td valign="top"><a href="#Auth">3.2 Auth</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-C">C</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-command-execution">command execution</a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-D">D</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-data-transferring">data transferring</a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-F">F</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-file-transfer">file transfer</a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP">3.13 SFTP</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fingerprint">fingerprint</a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-fingerprint-2">fingerprint</a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-H">H</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-handling-of-requests">handling of requests</a></td><td>&nbsp;</td><td valign="top"><a href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-handling-session-errors">handling session errors</a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-L">L</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-logging">logging</a></td><td>&nbsp;</td><td valign="top"><a href="#Logging">3.9 Logging</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-N">N</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-non_002dinteractive-SSH-session">non-interactive SSH session</a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-P">P</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-Port-forwarding">Port forwarding</a></td><td>&nbsp;</td><td valign="top"><a href="#Port-Forwarding">3.5.2 Port Forwarding</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-private-keys">private keys</a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-public-keys">public keys</a></td><td>&nbsp;</td><td valign="top"><a href="#Keys">3.4 Keys</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-R">R</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-remote-pipes">remote pipes</a></td><td>&nbsp;</td><td valign="top"><a href="#Remote-Pipes">3.7 Remote Pipes</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-S">S</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-secure-distributed-computing">secure distributed computing</a></td><td>&nbsp;</td><td valign="top"><a href="#Distributed-Forms">3.14 Distributed Forms</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-secure-shell">secure shell</a></td><td>&nbsp;</td><td valign="top"><a href="#Shell">3.8 Shell</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-servers">servers</a></td><td>&nbsp;</td><td valign="top"><a href="#Servers">3.11 Servers</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-sessions">sessions</a></td><td>&nbsp;</td><td valign="top"><a href="#Session-Management">3.1.1 Session Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-setting-of-environment-variables">setting of environment variables</a></td><td>&nbsp;</td><td valign="top"><a href="#Channel-Management">3.5.1 Channel Management</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-SFTP">SFTP</a></td><td>&nbsp;</td><td valign="top"><a href="#SFTP">3.13 SFTP</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-T">T</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-talking-to-a-SSH-client">talking to a SSH client</a></td><td>&nbsp;</td><td valign="top"><a href="#Messages">3.12 Messages</a></td></tr>
<tr><td></td><td valign="top"><a href="#index-Tunnels">Tunnels</a></td><td>&nbsp;</td><td valign="top"><a href="#Tunnels">3.6 Tunnels</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
<tr><th><a name="Concept-Index-1_cp_letter-V">V</a></th><td></td><td></td></tr>
<tr><td></td><td valign="top"><a href="#index-versions">versions</a></td><td>&nbsp;</td><td valign="top"><a href="#Version">3.10 Version</a></td></tr>
<tr><td colspan="4"> <hr></td></tr>
</table>
<table><tr><th valign="top">Jump to: &nbsp; </th><td><a class="summary-letter" href="#Concept-Index-1_cp_letter-A"><b>A</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-C"><b>C</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-D"><b>D</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-F"><b>F</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-H"><b>H</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-L"><b>L</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-N"><b>N</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-P"><b>P</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-R"><b>R</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-S"><b>S</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-T"><b>T</b></a>
 &nbsp; 
<a class="summary-letter" href="#Concept-Index-1_cp_letter-V"><b>V</b></a>
 &nbsp; 
</td></tr></table>

<hr size="6">
<a name="SEC_Contents"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Introduction-1" href="#Introduction">1 Introduction</a>
  <ul class="no-bullet">
    <li><a name="toc-The-goals-of-this-_0028humble_0029-project" href="#The-goals-of-this-_0028humble_0029-project">1.1 The goals of this (humble) project</a></li>
  </ul></li>
  <li><a name="toc-Installation-1" href="#Installation">2 Installation</a>
  <ul class="no-bullet">
    <li><a name="toc-GNU-Guix" href="#GNU-Guix">2.1 GNU Guix</a></li>
    <li><a name="toc-Ubuntu-GNU_002fLinux" href="#Ubuntu-GNU_002fLinux">2.2 Ubuntu GNU/Linux</a></li>
    <li><a name="toc-Other-Platforms" href="#Other-Platforms">2.3 Other Platforms</a></li>
    <li><a name="toc-Manual-Installation" href="#Manual-Installation">2.4 Manual Installation</a></li>
  </ul></li>
  <li><a name="toc-API-Reference-1" href="#API-Reference">3 API Reference</a>
  <ul class="no-bullet">
    <li><a name="toc-Sessions-1" href="#Sessions">3.1 Sessions</a>
    <ul class="no-bullet">
      <li><a name="toc-Session-Management-1" href="#Session-Management">3.1.1 Session Management</a></li>
      <li><a name="toc-Callbacks-1" href="#Callbacks">3.1.2 Callbacks</a></li>
    </ul></li>
    <li><a name="toc-Auth-1" href="#Auth">3.2 Auth</a></li>
    <li><a name="toc-Agent-1" href="#Agent">3.3 Agent</a>
    <ul class="no-bullet">
      <li><a name="toc-Starting_002fstopping-SSH-agents" href="#Starting_002fstopping-SSH-agents">3.3.1 Starting/stopping SSH agents</a></li>
      <li><a name="toc-Getting-information-about-SSH-agents" href="#Getting-information-about-SSH-agents">3.3.2 Getting information about SSH agents</a></li>
      <li><a name="toc-Managing-SSH-agent-environment-variables" href="#Managing-SSH-agent-environment-variables">3.3.3 Managing SSH agent environment variables</a></li>
    </ul></li>
    <li><a name="toc-Keys-1" href="#Keys">3.4 Keys</a></li>
    <li><a name="toc-Channels-1" href="#Channels">3.5 Channels</a>
    <ul class="no-bullet">
      <li><a name="toc-Channel-Management-1" href="#Channel-Management">3.5.1 Channel Management</a></li>
      <li><a name="toc-Port-Forwarding-1" href="#Port-Forwarding">3.5.2 Port Forwarding</a></li>
    </ul></li>
    <li><a name="toc-Tunnels-1" href="#Tunnels">3.6 Tunnels</a>
    <ul class="no-bullet">
      <li><a name="toc-Example" href="#Example">3.6.1 Example</a></li>
    </ul></li>
    <li><a name="toc-Remote-Pipes-1" href="#Remote-Pipes">3.7 Remote Pipes</a>
    <ul class="no-bullet">
      <li><a name="toc-Examples-2" href="#Examples-2">3.7.1 Examples</a>
      <ul class="no-bullet">
        <li><a name="toc-Simple-cases" href="#Simple-cases">3.7.1.1 Simple cases</a></li>
        <li><a name="toc-Executing-a-command-with-a-pseudo-terminal" href="#Executing-a-command-with-a-pseudo-terminal">3.7.1.2 Executing a command with a pseudo terminal</a></li>
        <li><a name="toc-Controlling-the-pseudo-terminal-size" href="#Controlling-the-pseudo-terminal-size">3.7.1.3 Controlling the pseudo terminal size</a></li>
      </ul>
</li>
    </ul></li>
    <li><a name="toc-Shell-1" href="#Shell">3.8 Shell</a></li>
    <li><a name="toc-Logging-1" href="#Logging">3.9 Logging</a></li>
    <li><a name="toc-Version-1" href="#Version">3.10 Version</a></li>
    <li><a name="toc-Servers-1" href="#Servers">3.11 Servers</a></li>
    <li><a name="toc-Messages-1" href="#Messages">3.12 Messages</a>
    <ul class="no-bullet">
      <li><a name="toc-Messages-Handling" href="#Message-Handling">3.12.1 Messages Handling</a></li>
      <li><a name="toc-Parsing-of-Requests-1" href="#Parsing-of-Requests">3.12.2 Parsing of Requests</a></li>
    </ul></li>
    <li><a name="toc-SFTP-1" href="#SFTP">3.13 SFTP</a>
    <ul class="no-bullet">
      <li><a name="toc-SFTP-session" href="#SFTP-session">3.13.1 SFTP session</a>
      <ul class="no-bullet">
        <li><a name="toc-Low_002dLevel-API" href="#Low_002dLevel-API">3.13.1.1 Low-Level API</a></li>
      </ul></li>
      <li><a name="toc-SFTP-file" href="#SFTP-file">3.13.2 SFTP file</a></li>
      <li><a name="toc-High_002dlevel-operations-on-remote-files" href="#High_002dlevel-operations-on-remote-files">3.13.3 High-level operations on remote files</a></li>
    </ul></li>
    <li><a name="toc-Distributed-Forms-1" href="#Distributed-Forms">3.14 Distributed Forms</a>
    <ul class="no-bullet">
      <li><a name="toc-Low_002dlevel-API" href="#Low_002dlevel-API">3.14.1 Low-level API</a>
      <ul class="no-bullet">
        <li><a name="toc-Nodes" href="#Nodes">3.14.1.1 Nodes</a></li>
        <li><a name="toc-Jobs" href="#Jobs">3.14.1.2 Jobs</a></li>
      </ul>
</li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Examples-1" href="#Examples">4 Examples</a>
  <ul class="no-bullet">
    <li><a name="toc-Client" href="#Client">4.1 Client</a></li>
    <li><a name="toc-Server" href="#Server">4.2 Server</a></li>
  </ul></li>
  <li><a name="toc-Acknowledgments-1" href="#Acknowledgments">5 Acknowledgments</a></li>
  <li><a name="toc-GNU-Free-Documentation-License-1" href="#GNU-Free-Documentation-License">Appendix A GNU Free Documentation License</a></li>
  <li><a name="toc-Type-Index-1" href="#Type-Index">Type Index</a></li>
  <li><a name="toc-Procedure-Index-1" href="#Procedure-Index">Procedure Index</a></li>
  <li><a name="toc-Concept-Index-1" href="#Concept-Index">Concept Index</a></li>
</ul>
</div>
<hr>
<a name="SEC_About"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Type-Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>

<p>
  This document was generated on <i>September 11, 2022</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr>
<p>
 <font size="-1">
  This document was generated on <i>September 11, 2022</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
 </font>
 <br>

</p>
</body>
</html>
